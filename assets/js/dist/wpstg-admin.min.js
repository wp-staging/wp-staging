!function(){"use strict";function t(){t=function(){return e};var e={},n=Object.prototype,o=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,o){var r=e&&e.prototype instanceof g?e:g,i=Object.create(r.prototype),a=new T(o||[]);return s(i,"_invoke",{value:k(t,n,a)}),i}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p={};function g(){}function h(){}function w(){}var f={};l(f,i,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(_([])));v&&v!==n&&o.call(v,i)&&(f=v);var b=w.prototype=g.prototype=Object.create(f);function y(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(s,r,i,a){var c=d(t[s],t,r);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&o.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,a)}))}a(c.arg)}var r;s(this,"_invoke",{value:function(t,o){function s(){return new e((function(e,s){n(t,o,e,s)}))}return r=r?r.then(s,s):s()}})}function k(t,e,n){var o="suspendedStart";return function(s,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===s)throw r;return L()}for(n.method=s,n.arg=r;;){var i=n.delegate;if(i){var a=S(i,n);if(a){if(a===p)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var c=d(t,e,n);if("normal"===c.type){if(o=n.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o="completed",n.method="throw",n.arg=c.arg)}}}function S(t,e){var n=e.method,o=t.iterator[n];if(void 0===o)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var s=d(o,t.iterator,e.arg);if("throw"===s.type)return e.method="throw",e.arg=s.arg,e.delegate=null,p;var r=s.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function _(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,s=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return s.next=s}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=w,s(b,"constructor",{value:w,configurable:!0}),s(w,"constructor",{value:h,configurable:!0}),h.displayName=l(w,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},y(x.prototype),l(x.prototype,a,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,o,s,r){void 0===r&&(r=Promise);var i=new x(u(t,n,o,s),r);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},y(b),l(b,c,"Generator"),l(b,i,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var o in e)n.push(o);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},e.values=_,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,o){return i.type="throw",i.arg=t,e.next=n,o&&(e.method="next",e.arg=void 0),!!o}for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s],i=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var a=o.call(r,"catchLoc"),c=o.call(r,"finallyLoc");if(a&&c){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&o.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=t,i.arg=e,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var s=o.arg;C(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function e(t,e,n,o,s,r,i){try{var a=t[r](i),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(o,s)}function n(t){return function(){var n=this,o=arguments;return new Promise((function(s,r){var i=t.apply(n,o);function a(t){e(i,s,r,a,c,"next",t)}function c(t){e(i,s,r,a,c,"throw",t)}a(void 0)}))}}function o(){return o=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},o.apply(this,arguments)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0;return function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i=(Element.prototype.closest&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(t){var e=this;do{if(Element.prototype.matches.call(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}),function(t,e){return t instanceof Element?t.closest(e):null});function a(t,e,n,o){var s,r,i,a,c=!1,l=!1,u={},d=0,p=0,g={sensitivity:7,interval:100,timeout:0,handleFocus:!1};function h(t){s=t.clientX,r=t.clientY}function w(t,e){if(p&&(p=clearTimeout(p)),Math.abs(i-s)+Math.abs(a-r)<g.sensitivity)return d=1,l?void 0:n(t,e);i=s,a=r,p=setTimeout((function(){w(t,e)}),g.interval)}function f(t,e){return c=!0,p&&(p=clearTimeout(p)),t.removeEventListener("mousemove",h,!1),1!==d&&(i=e.clientX,a=e.clientY,t.addEventListener("mousemove",h,!1),p=setTimeout((function(){w(t,e)}),g.interval)),this}function m(t){t.target.matches(e+", "+e+" *")&&f(t.target.closest(e),t)}function v(t,e){return c=!1,p&&(p=clearTimeout(p)),t.removeEventListener("mousemove",h,!1),1===d&&(p=setTimeout((function(){!function(t,e){p&&(p=clearTimeout(p)),d=0,l||o(t,e)}(t,e)}),g.timeout)),this}function b(t){t.target.matches(e+", "+e+" *")&&v(t.target.closest(e),t)}function y(t){var o,s;t.target.matches(e+", "+e+" *")&&(o=t.target.closest(e),s=t,c||(l=!0,n(o,s)))}function x(t){var n,s;t.target.matches(e+", "+e+" *")&&(n=t.target.closest(e),s=t,!c&&l&&(l=!1,o(n,s)))}function k(){t.removeEventListener("focus",y,!1),t.removeEventListener("blur",x,!1)}return u.options=function(e){var n=e.handleFocus!==g.handleFocus;return g=Object.assign({},g,e),n&&(g.handleFocus?(t.addEventListener("focus",y,!1),t.addEventListener("blur",x,!1)):k()),u},u.remove=function(){t&&(t.removeEventListener("mouseover",m,!1),t.removeEventListener("mouseout",b,!1),k())},t&&(t.addEventListener("mouseover",m,!1),t.addEventListener("mouseout",b,!1)),u}var c=function(){function e(t){void 0===t&&(t=wpstg),this.wpstgObject=t}return e.prototype.sendRequest=function(){var e=n(t().mark((function e(n){var o,s;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(this.wpstgObject.ajaxUrl,{method:"POST",credentials:"same-origin",body:new URLSearchParams({action:"wpstg--detect-memory-exhaust",requestType:n,accessToken:this.wpstgObject.accessToken,nonce:this.wpstgObject.nonce}),headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 3:return o=t.sent,t.next=6,o.json();case 6:if(void 0===(s=t.sent).status||!s.status||!s.error){t.next=9;break}return t.abrupt("return",s);case 9:console.warn(s.message),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.warn(this.wpstgObject.i18n.somethingWentWrong,t.t0);case 15:return t.abrupt("return",!1);case 16:case"end":return t.stop()}}),e,this,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),e}(),l=function(e){var o={continueErrorHandle:!0,retry:{currentDelay:0,count:0,max:10,retryOnErrors:[401,403,404,429,502,503,504],performingRequest:!1,incrementRetry:function(t){void 0===t&&(t=1.25),o.retry.performingRequest=!0,0===o.retry.currentDelay&&(o.retry.currentDelay=1e3,o.retry.count=1),o.retry.currentDelay+=500*o.retry.count*t,o.retry.count++},canRetry:function(){return o.retry.count<o.retry.max},reset:function(){o.retry.currentDelay=0,o.retry.count=0,o.retry.performingRequest=!1}},memoryExhaustArticleLink:"https://wp-staging.com/docs/php-fatal-error-allowed-memory-size-of-134217728-bytes-exhausted/",cache:{elements:[],get:function(t){return-1!==e.inArray(t,this.elements)||(this.elements[t]=e(t)),this.elements[t]},refresh:function(t){t.elements[t]=e(t)}},setJobId:function(t){localStorage.setItem("jobIdBeingProcessed",t)},getJobId:function(){return localStorage.getItem("jobIdBeingProcessed")},checkMemoryExhaustion:function(e){return n(t().mark((function n(){var o,s;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new c,t.next=3,o.sendRequest(e);case 3:if(s=t.sent){t.next=6;break}return t.abrupt("return",!1);case 6:return t.abrupt("return",s);case 10:case"end":return t.stop()}}),n)})))()},listenTooltip:function(){a(document,".wpstg--tooltip",(function(t,e){t.querySelector(".wpstg--tooltiptext").style.visibility="visible"}),(function(t,e){t.querySelector(".wpstg--tooltiptext").style.visibility="hidden"}))},getSwalModal:function(t,e){void 0===t&&(t=!1),void 0===e&&(e={});var n={confirmButton:"wpstg--btn--confirm wpstg-blue-primary wpstg-button wpstg-link-btn wpstg-100-width",cancelButton:"wpstg--btn--cancel wpstg-blue-primary wpstg-link-btn wpstg-100-width",actions:"wpstg--modal--actions",popup:t?"wpstg-swal-popup wpstg-centered-modal":"wpstg-swal-popup"},o={customClass:Object.assign(n,e),buttonsStyling:!1,reverseButtons:!0,showClass:{popup:"wpstg--swal2-show wpstg-swal-show"}};return wpstgSwal.mixin(o)},showSuccessModal:function(t){this.getSwalModal().fire({showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"OK",icon:"success",title:"Success!",html:'<div class="wpstg--grey" style="text-align: left; margin-top: 8px;">'+t+"</div>"})},showWarningModal:function(t){this.getSwalModal().fire({showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"OK",icon:"warning",title:"",html:'<div class="wpstg--grey" style="text-align: left; margin-top: 8px;">'+t+"</div>"})},showErrorModal:function(t){this.getSwalModal().fire({showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"OK",icon:"error",title:"Error!",html:'<div class="wpstg--grey" style="text-align: left; margin-top: 8px;">'+t+"</div>"})},getSwalContainer:function(){return wpstgSwal.getContainer()},closeSwalModal:function(){wpstgSwal.close()},getDataFromWordPressResponse:function(t){if("object"!=typeof t)throw new Error("Unexpected response (ERR 1341)");if(!t.hasOwnProperty("success"))throw new Error("Unexpected response (ERR 1342)");if(!t.hasOwnProperty("data"))throw new Error("Unexpected response (ERR 1343)");if(!1===t.success)throw t.data instanceof Array&&t.data.length>0?new Error(t.data.shift()):new Error("Response was not successful");return t.data},isLoading:function(t){t&&!1!==t?o.cache.get(".wpstg-loader").show():o.cache.get(".wpstg-loader").hide()},slugify:function(t){return t.toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"-").replace(/&/g,"-and-").replace(/[^a-z0-9\-]/g,"").replace(/-+/g,"-").replace(/^-*/,"").replace(/-*$/,"")},showAjaxFatalError:function(t,e,n){return e=e?e+"<br/><br/>":"Something went wrong! <br/><br/>",n=n?n+"<br/><br/>":"<br/><br/>Please try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.",!1===t?(o.showError(e+" Error: No response."+n),void window.removeEventListener("beforeunload",WPStaging.warnIfClosingDuringProcess)):void 0!==t.error&&t.error?(o.showError(e+" Error: "+t.message+n),void window.removeEventListener("beforeunload",WPStaging.warnIfClosingDuringProcess)):void 0},handleFetchErrors:function(t){return t.ok||o.showError("Error: "+t.status+" - "+t.statusText+". Please try again or contact support."),t},showError:function(t){o.retry.performingRequest||(o.cache.get("#wpstg-try-again").css("display","inline-block"),o.cache.get("#wpstg-cancel-cloning").text("Reset"),o.cache.get("#wpstg-resume-cloning").show(),o.cache.get("#wpstg-error-wrapper").show(),o.cache.get("#wpstg-error-details").show().html(t),o.cache.get("#wpstg-removing-clone").removeClass("loading"),o.cache.get(".wpstg-loader").hide(),e(".wpstg--modal--process--generic-problem").show().html(t))},resetErrors:function(){o.cache.get("#wpstg-error-details").hide().html("")},ajax:function(t,n,s,r,i,a,c){void 0===a&&(a=null),void 0===c&&(c=null),void 0===s&&(s="json"),!1!==r&&(r=!0);var l=10,u=1e4*(i=void 0===i?0:i);a=parseInt(a),isNaN(a)||(u*=a),e.ajax({url:ajaxurl+"?action=wpstg_processing&_="+Date.now()/1e3,type:"POST",dataType:s,cache:!1,data:t,error:function(e,d,p){if(console.log(e.status+" "+e.statusText+"---"+d),"function"!=typeof c||(c(e,d,p),o.continueErrorHandle))if(++i<=l)setTimeout((function(){o.ajax(t,n,s,r,i,a)}),u);else{var g=void 0===e.status?"Unknown":e.status;o.showError("Fatal Error:  "+g+" Please try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.")}else o.continueErrorHandle=!0},success:function(t){"function"==typeof n&&n(t)},statusCode:{404:function(){i>=l&&o.showError("Error 404 - Can't find ajax request URL! Please try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.")},500:function(){i>=l&&o.showError("Fatal Error 500 - Internal server error while processing the request! Please try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.")},504:function(){i>l&&o.showError("Error 504 - It looks like your server is rate limiting ajax requests. Please try to resume after a minute. If this still not works try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.\n ")},502:function(){i>=l&&o.showError("Error 502 - It looks like your server is rate limiting ajax requests. Please try to resume after a minute. If this still not works try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.\n ")},503:function(){i>=l&&o.showError("Error 503 - It looks like your server is rate limiting ajax requests. Please try to resume after a minute. If this still not works try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.\n ")},429:function(){i>=l&&o.showError("Error 429 - It looks like your server is rate limiting ajax requests. Please try to resume after a minute. If this still not works try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.\n ")},403:function(){i>=l&&o.showError("Refresh page or login again! The process should be finished successfully. \n ")}}})}};return o}(jQuery);function u(t){return document.querySelector(t)}function d(t){return document.querySelectorAll(t)}function p(t,e,n,o){!t instanceof Element||t.addEventListener(e,(function(t){t.target.matches(n+", "+n+" *")&&o(t.target.closest(n),t)}),!1)}function g(t,e){void 0===e&&(e=400),t.style.display="block",t.style.overflow="hidden";var n=t.offsetHeight;t.style.height="0px",t.style.transitionProperty="height",t.style.transitionDuration=e+"ms",setTimeout((function(){t.style.height=n+"px",window.setTimeout((function(){t.style.removeProperty("height"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property")}),e)}),0)}function h(t,e){void 0===e&&(e=400),t.style.display="block",t.style.overflow="hidden";var n=t.offsetHeight;t.style.height=n+"px",t.style.transitionProperty="height",t.style.transitionDuration=e+"ms",setTimeout((function(){t.style.height="0px",window.setTimeout((function(){t.style.display="none",t.style.removeProperty("height"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property")}),e)}),0)}function w(t,e){for(var n=t.previousElementSibling;n;){if(n.matches(e))return n;n=n.previousElementSibling}}function f(t){if(!(!t instanceof Element)&&t.id){var e="hidden";if("checkbox"!==t.getAttribute("type"));else{var n=i(t,".wpstg-container");if(null===n)return;var o=n.querySelectorAll('[data-show-if-checked="'+t.id+'"]'),s=n.querySelectorAll('[data-show-if-unchecked="'+t.id+'"]'),a=t.checked;if(o.length)for(var c,l=r(o);!(c=l()).done;){var u=c.value;a?u.classList.remove(e):u.classList.add(e)}if(s.length)for(var d,p=r(s);!(d=p()).done;){var g=d.value;a?g.classList.add(e):g.classList.remove(e)}}}}function m(t){if(!(!t instanceof Element)&&t.getAttribute("data-wpstg-target")){var e=i(t,".wpstg_admin");if(null!==e){var n=e.querySelectorAll(t.getAttribute("data-wpstg-target"));if(n.length)for(var o,s=r(n);!(o=s()).done;){o.value.classList.toggle("hidden")}}}}function v(t){if(!(!t instanceof Element)&&t.getAttribute("data-wpstg-target")&&t.getAttribute("data-wpstg-copy")){var e=i(t,".wpstg_admin");if(null!==e){navigator.clipboard.writeText(t.getAttribute("data-wpstg-copy"));var n=e.querySelectorAll(t.getAttribute("data-wpstg-target"));if(n.length)for(var o,s=r(n);!(o=s()).done;){o.value.value=t.getAttribute("data-wpstg-copy","")}}}}function b(t){if(!(!t instanceof Element)&&t.getAttribute("data-wpstg-source")){var e=i(t,".wpstg_admin");if(null!==e){var n=e.querySelector(t.getAttribute("data-wpstg-source"));n&&navigator.clipboard.writeText(n.value)}}}function y(t){document.querySelectorAll(t).forEach((function(t){t.style.display="none"}))}function x(t){document.querySelectorAll(t).forEach((function(t){t.style.display="block"}))}function k(t){void 0===t&&(t="visible"),document.querySelectorAll(".wpstg-loading-bar-container").forEach((function(e){e&&(e.style.visibility=t)}))}var S=function(){function t(){this.init()}var e=t.prototype;return e.init=function(){this.wpstdStagingTab=document.querySelector("#wpstg--tab--toggle--staging"),this.wpstdBackupTab=document.querySelector("#wpstg--tab--toggle--backup"),this.wpstdSidebarMenu=document.querySelector("#toplevel_page_wpstg_clone"),this.addEvents()},e.addEvents=function(){var t=this;null!==this.wpstdStagingTab&&this.wpstdStagingTab.addEventListener("click",(function(){t.setPageUrl("wpstg_clone"),t.setSidebarMenu("wpstg_clone")})),null!==this.wpstdBackupTab&&this.wpstdBackupTab.addEventListener("click",(function(){t.setPageUrl("wpstg_backup"),t.setSidebarMenu("wpstg_backup")}))},e.setPageUrl=function(t){window.history.pushState(null,null,window.location.pathname+"?page="+t)},e.setSidebarMenu=function(t){var e=this.wpstdSidebarMenu.querySelector("ul").querySelectorAll("li");if(e.length>0)for(var n=0;n<e.length;n++)e[n].classList.remove("current"),null!==e[n].querySelector("a")&&e[n].querySelector("a").getAttribute("href")==="admin.php?page="+t&&e[n].classList.add("current")},t}(),E=function(){function t(t,e){void 0===t&&(t="contact-us"),void 0===e&&(e=wpstg),this.wpstgObject=e,this.characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",this.currentDate=new Date,this.modalType=t,this.init()}var e=t.prototype;return e.init=function(){this.contactUsModal="#wpstg-"+this.modalType+"-modal",this.askInTheForumForm=this.contactUsModal+" #wpstg-"+this.modalType+"-report-issue-form",this.contactUsSuccessPopup=this.contactUsModal+" #wpstg-"+this.modalType+"-success-form",this.contactUsLoader=this.contactUsModal+" #wpstg-"+this.modalType+"-report-issue-loader",this.contactUsSupport=this.contactUsModal+" #wpstg-"+this.modalType+"-support-forum",this.contactUsButton=document.querySelector("#wpstg-"+this.modalType+"-button"),this.contactUsButtonBackupTab=document.querySelector("#wpstg--tab--backup  #wpstg-"+this.modalType+"-button"),this.reportIssueButton=document.querySelector("#wpstg-contact-us-report-issue"),this.successForm=document.querySelector(this.contactUsModal+" #wpstg-"+this.modalType+"-success-form"),this.contactUsReportIssueBtn=document.querySelector(this.contactUsModal+" #wpstg-"+this.modalType+"-report-issue-btn"),this.contactUsCloseButton=document.querySelector(this.contactUsModal+" #wpstg-modal-close"),this.contactUsSuccessPopupClose=document.querySelector(this.contactUsModal+" #wpstg-"+this.modalType+"-success-modal-close"),this.debugCodeCopyButton=document.querySelector(this.contactUsModal+" #wpstg-"+this.modalType+"-debug-code-copy"),this.contactUsResponse=document.querySelector(this.contactUsModal+" #wpstg-"+this.modalType+"-debug-response"),this.contactUsDebugCodeField=document.querySelector(this.contactUsModal+" #wpstg-"+this.modalType+"-debug-code"),this.isDebugWindowOpened=!1,this.addEvents(),this.notyf=new Notyf({duration:6e3,position:{x:"center",y:"bottom"},dismissible:!0,types:[{type:"warning",background:"orange",icon:!0}]})},e.addEvents=function(){var t=this;document.addEventListener("keydown",(function(e){"Escape"===e.key&&(y(t.contactUsModal),y(t.askInTheForumForm),y(t.contactUsSuccessPopup),y(t.contactUsSupport),t.isDebugWindowOpened=!1)})),null!==this.contactUsButton&&this.contactUsButton.addEventListener("click",(function(){x(t.contactUsModal)})),null!==this.contactUsButtonBackupTab&&this.contactUsButtonBackupTab.addEventListener("click",(function(){x(t.contactUsModal)})),null!==this.reportIssueButton&&this.reportIssueButton.addEventListener("click",(function(){t.isDebugWindowOpened?y(t.askInTheForumForm):x(t.askInTheForumForm),t.isDebugWindowOpened=!t.isDebugWindowOpened})),null!==this.contactUsReportIssueBtn&&this.contactUsReportIssueBtn.addEventListener("click",(function(){t.sendDebugInfo()})),null!==this.contactUsSuccessPopupClose&&this.contactUsSuccessPopupClose.addEventListener("click",(function(){y(t.contactUsSuccessPopup)})),null!==this.contactUsCloseButton&&this.contactUsCloseButton.addEventListener("click",(function(){y(t.contactUsModal),y(t.contactUsSupport),y(t.askInTheForumForm),t.isDebugWindowOpened=!1})),null!==this.debugCodeCopyButton&&this.debugCodeCopyButton.addEventListener("click",(function(){t.copyDebugCode(),t.notyf.success("Debug code copied to clipboard")}))},e.copyDebugCode=function(){this.contactUsDebugCodeField.select(),this.contactUsDebugCodeField.setSelectionRange(0,99999),navigator.clipboard.writeText(this.contactUsDebugCodeField.value)},e.generateDebugCode=function(t){for(var e="",n=0;n<t;n++)e+=this.characters.charAt(Math.floor(Math.random()*this.characters.length));return"wpstg-"+e+"-"+this.currentDate.getHours()+this.currentDate.getMinutes()+this.currentDate.getSeconds()},e.sendDebugInfo=function(){var t=this;x(this.contactUsLoader),this.contactUsReportIssueBtn.disabled=!0;var e=this.generateDebugCode(8);fetch(this.wpstgObject.ajaxUrl,{method:"POST",credentials:"same-origin",body:new URLSearchParams({action:"wpstg_send_debug_log_report",accessToken:this.wpstgObject.accessToken,nonce:this.wpstgObject.nonce,debugCode:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){if(t.contactUsReportIssueBtn.disabled=!1,e.ok)return e.json()})).then((function(n){n.response&&!0===n.response.sent?(t.contactUsDebugCodeField.value=e,x(t.contactUsSuccessPopup),window.debugCode=e):(t.contactUsDebugCodeField.value=void 0===window.debugCode?e:window.debugCode,x(t.contactUsSuccessPopup)),y(t.contactUsLoader)})).catch((function(e){y(t.contactUsLoader),x(t.contactUsSupport),console.warn(t.wpstgObject.i18n.somethingWentWrong,e)}))},t}(),C=function(){function t(t,e){void 0===t&&(t="#wpstg-clonepage-wrapper"),void 0===e&&(e=wpstg),this.pageWrapper=u(t),this.wpstgObject=e,this.enableButtonId="#wpstg-enable-staging-cloning",this.enableAction="wpstg_enable_staging_cloning",this.notyf=new Notyf({duration:1e4,position:{x:"center",y:"bottom"},dismissible:!0,types:[{type:"warning",background:"orange",icon:!1}]}),this.init()}var e=t.prototype;return e.addEvents=function(){var t=this;null!==this.pageWrapper&&(p(this.pageWrapper,"click",this.enableButtonId,(function(){t.sendRequest(t.enableAction)})),new S)},e.init=function(){this.addEvents()},e.sendRequest=function(t){var e=this;fetch(this.wpstgObject.ajaxUrl,{method:"POST",credentials:"same-origin",body:new URLSearchParams({action:t,accessToken:this.wpstgObject.accessToken,nonce:this.wpstgObject.nonce}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(t){void 0!==t.success&&t.success?location.reload():void 0===t.message?e.notyf.error(e.wpstgObject.i18n.somethingWentWrong):e.notyf.error(t.message)})).catch((function(t){console.warn(e.wpstgObject.i18n.somethingWentWrong,t)}))},t}(),T=function(){function t(t,e,n){void 0===t&&(t="#wpstg-directories-listing"),void 0===e&&(e=l),void 0===n&&(n=null),this.directoryListingContainer=u(t),this.wpstgObject=e,this.dirCheckboxSelector=".wpstg-check-dir",this.dirExpandSelector=".wpstg-expand-dirs",this.unselectAllDirsSelector=".wpstg-unselect-dirs",this.selectDefaultDirsSelector=".wpstg-select-dirs-default",this.fetchChildrenAction="wpstg_fetch_dir_children",this.currentCheckboxElement=null,this.currentParentDiv=null,this.currentLoader=null,this.existingExcludes=[],this.excludedDirectories=[],this.isDefaultSelected=!1,this.notyf=n,this.init()}var e=t.prototype;return e.addEvents=function(){var t=this;null!==this.directoryListingContainer?(p(this.directoryListingContainer,"change",this.dirCheckboxSelector,(function(t,e){e.preventDefault()})),p(this.directoryListingContainer,"click",this.dirExpandSelector,(function(e,n){n.preventDefault(),t.toggleDirExpand(e)&&t.sendRequest(t.fetchChildrenAction,e)})),p(this.directoryListingContainer,"click",this.unselectAllDirsSelector,(function(){t.unselectAll()})),p(this.directoryListingContainer,"click",this.selectDefaultDirsSelector,(function(){t.selectDefault()})),p(this.directoryListingContainer,"click",".wpstg-expand-dirs",(function(e,n){n.preventDefault(),t.toggleDirectoryNavigation(e)})),p(this.directoryListingContainer,"change","input.wpstg-check-dir",(function(e){t.updateDirectorySelection(e)}))):console.log("Error: Unable to add directory navigation events.")},e.init=function(){this.addEvents(),this.parseExcludes()},e.toggleDirExpand=function(t){return this.currentParentDiv=t.parentElement,this.currentCheckboxElement=w(t,"input"),this.currentLoader=this.currentParentDiv.querySelector(".wpstg-is-dir-loading"),"false"!==this.currentCheckboxElement.getAttribute("wpstg-data-navigateable","false")&&"false"===this.currentCheckboxElement.getAttribute("wpstg-data-scanned","false")},e.sendRequest=function(t){var e=this;null!==this.currentLoader&&(this.currentLoader.style.display="inline-block");var n=this.currentCheckboxElement.getAttribute("wpstg-data-changed"),o=this.currentCheckboxElement.getAttribute("wpstg-data-path"),s=this.currentCheckboxElement.getAttribute("wpstg-data-prefix");fetch(this.wpstgObject.ajaxUrl,{method:"POST",credentials:"same-origin",body:new URLSearchParams({action:t,accessToken:this.wpstgObject.accessToken,nonce:this.wpstgObject.nonce,dirPath:o,prefix:s,isChecked:this.currentCheckboxElement.checked,forceDefault:"true"===n}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(t){if(void 0!==t.success&&t.success){e.currentCheckboxElement.setAttribute("wpstg-data-scanned",!0);var n=document.createElement("div");return n.classList.add("wpstg-dir"),n.classList.add("wpstg-subdir"),n.innerHTML=JSON.parse(t.directoryListing),e.currentParentDiv.appendChild(n),null!==e.currentLoader&&(e.currentLoader.style.display="none"),void g(n)}null!==e.notyf?e.notyf.error(e.wpstgObject.i18n.somethingWentWrong):alert("Error: "+e.wpstgObject.i18n.somethingWentWrong)})).catch((function(t){console.warn(e.wpstgObject.i18n.somethingWentWrong,t)}))},e.getExcludedDirectories=function(){var t,e=this;return this.excludedDirectories=[],this.directoryListingContainer.querySelectorAll(".wpstg-dir input:not(:checked)").forEach((function(t){e.isParentExcluded(t.value)||e.excludedDirectories.push(t.value)})),this.existingExcludes||(this.existingExcludes=[]),this.existingExcludes.forEach((function(t){e.isParentExcluded(t)||e.isScanned(t)||e.excludedDirectories.push(t)})),this.excludedDirectories.join(null==(t=this.wpstgObject.settings)?void 0:t.directorySeparator)},e.isParentExcluded=function(t){var e=!1;return this.excludedDirectories.forEach((function(n){t.startsWith(n+"/")&&(e=!0)})),e},e.getExtraDirectoriesRootOnly=function(){this.getExcludedDirectories();var t=[];this.directoryListingContainer.querySelectorAll(":not(.wpstg-subdir)>.wpstg-dir>input.wpstg-wp-non-core-dir:checked").forEach((function(e){t.push(e.value)}));var e,n=u("#wpstg_extraDirectories");if(null===n||""===n.value)return t.join(null==(e=this.wpstgObject.settings)?void 0:e.directorySeparator);var o=n.value.split(/\r?\n/);return t.concat(o).join(this.wpstgObject.settings.directorySeparator)},e.unselectAll=function(){this.directoryListingContainer.querySelectorAll(".wpstg-dir input").forEach((function(t){t.checked=!1})),this.countSelectedFiles()},e.selectDefault=function(){this.unselectAll(),this.directoryListingContainer.querySelectorAll(".wpstg-dir input.wpstg-wp-core-dir").forEach((function(t){t.checked=!0})),this.directoryListingContainer.querySelectorAll(".wpstg-dir > .wpstg-wp-non-core-dir").forEach((function(t){t.parentElement.querySelectorAll("input.wpstg-wp-core-dir").forEach((function(t){t.checked=!1}))})),this.isDefaultSelected=!0,this.countSelectedFiles()},e.parseExcludes=function(){if(this.existingExcludes=this.directoryListingContainer.getAttribute("wpstg-data-existing-excludes",[]),void 0!==this.existingExcludes&&this.existingExcludes)if(0!==this.existingExcludes.length){var t=this.existingExcludes.split(",");this.existingExcludes=t.map((function(t){return"/"===t.substr(0,1)?t.slice(1):t}))}else this.existingExcludes=[];else this.existingExcludes=[]},e.isScanned=function(t){var e=!1;return this.directoryListingContainer.querySelectorAll(".wpstg-dir>input").forEach((function(n){n.value===t&&(e=!0)})),e},e.toggleDirectoryNavigation=function(t){var e=w(t,"input");if("false"!==e.getAttribute("wpstg-data-navigateable","false")&&"false"!==e.getAttribute("wpstg-data-scanned","false")){var n=function(t,e){for(var n=t.nextElementSibling;n;){if(n.matches(e))return n;n=n.nextElementSibling}}(t,".wpstg-subdir");"none"===n.style.display?g(n):h(n)}},e.updateDirectorySelection=function(t){var e=t.parentElement;t.setAttribute("wpstg-data-changed","true"),t.checked?(function(t,e){for(var n=[],o=t&&t.parentElement;o;o=o.parentElement)o.matches(e)&&n.push(o);return n}(e,".wpstg-dir").forEach((function(t){for(var e=0;e<t.children.length;e++)t.children[e].matches(".wpstg-check-dir")&&(t.children[e].checked=!0)})),e.querySelectorAll(".wpstg-expand-dirs").forEach((function(t){"wp-admin"!==t.textContent&&"wp-includes"!==t.textContent&&t.classList.remove("disabled")})),e.querySelectorAll(".wpstg-subdir .wpstg-check-dir").forEach((function(t){t.checked=!0}))):(e.querySelectorAll(".wpstg-expand-dirs, .wpstg-check-subdirs").forEach((function(t){t.classList.add("disabled")})),e.querySelectorAll(".wpstg-dir .wpstg-check-dir").forEach((function(t){t.checked=!1}))),this.countSelectedFiles()},e.countSelectedFiles=function(){var t=this.directoryListingContainer.querySelectorAll('[wpstg-data-dir-type="theme"]:checked').length,e=this.directoryListingContainer.querySelectorAll('[wpstg-data-dir-type="plugin"]:checked').length,n=u("#wpstg-files-count");0===t&&0===e?(n.classList.add("danger"),n.innerHTML=this.wpstgObject.i18n.noFileSelected):(n.classList.remove("danger"),n.innerHTML=this.wpstgObject.i18n.filesSelected.replace("{t}",t).replace("{p}",e))},t}(),_=function(){function t(t,e,n,o,s){void 0===t&&(t="#wpstg-scanning-db"),void 0===e&&(e="#wpstg-workflow"),void 0===n&&(n="#wpstg_network_clone"),void 0===o&&(o="#wpstg_select_tables_cloning"),void 0===s&&(s=wpstg),this.databaseTableSection=u(t),this.workflow=u(e),this.networkCloneSelector=n,this.networkCloneCheckbox=u(n),this.wpstgObject=s,this.isAllTablesChecked=!0,this.isMultisite="1"===this.wpstgObject.isMultisite,this.isNetworkClone=!1,this.inputSelector=o,this.input=u(this.inputSelector),this.init()}var e=t.prototype;return e.setNetworkClone=function(t){this.isNetworkClone=t},e.addEvents=function(){var t=this;null!==this.workflow?(p(this.workflow,"change",this.networkCloneSelector,(function(){t.selectDefaultTables()})),p(this.workflow,"change",this.inputSelector,(function(){t.countSelectedTables()})),p(this.workflow,"click",".wpstg-button-select",(function(e,n){n.preventDefault(),t.selectDefaultTables()})),p(this.workflow,"click",".wpstg-button-unselect",(function(e,n){n.preventDefault(),t.toggleTableSelection()})),p(this.workflow,"click",".wpstg-button-unselect-wpstg",(function(e,n){n.preventDefault(),t.unselectWPSTGTables()}))):console.log("Error: database table section is null. Cannot register events")},e.init=function(){this.addEvents()},e.getRegexPattern=function(){var t="^"+this.wpstgObject.tblprefix,e=!1;return void 0!==this.networkCloneCheckbox&&null!==this.networkCloneCheckbox&&(e=this.networkCloneCheckbox.checked),this.isNetworkClone&&(e=!0),this.isMultisite&&!e&&(t+="([^0-9])_*"),t},e.selectDefaultTables=function(){var t=this.databaseTableSection.querySelectorAll("#wpstg_select_tables_cloning .wpstg-db-table"),e=this.getRegexPattern();t.forEach((function(t){t.getAttribute("name","").match(e)?t.selected=!0:t.selected=!1})),this.countSelectedTables()},e.toggleTableSelection=function(){!1===this.isAllTablesChecked?(this.databaseTableSection.querySelectorAll("#wpstg_select_tables_cloning .wpstg-db-table").forEach((function(t){t.selected=!0})),this.databaseTableSection.querySelector(".wpstg-button-unselect").innerHTML="Unselect All",this.isAllTablesChecked=!0):(this.databaseTableSection.querySelectorAll("#wpstg_select_tables_cloning .wpstg-db-table").forEach((function(t){t.selected=!1})),this.databaseTableSection.querySelector(".wpstg-button-unselect").innerHTML="Select All",this.isAllTablesChecked=!1),this.countSelectedTables()},e.unselectWPSTGTables=function(){var t=this,e=this.databaseTableSection.querySelectorAll("#wpstg_select_tables_cloning .wpstg-db-table");e.forEach((function(e){var n=e.getAttribute("name","");n.match("wpstg")&&!n.match(t.wpstgObject.tblprefix+"wpstg_queue")&&(e.selected=!1)})),this.countSelectedTables()},e.getSelectedTablesWithoutPrefix=function(){var t=[],e=this.databaseTableSection.querySelectorAll("#wpstg_select_tables_cloning option:checked"),n=this.getRegexPattern();return e.forEach((function(e){e.getAttribute("name","").match(n)||t.push(e.value)})),t.join(this.wpstgObject.settings.directorySeparator)},e.getIncludedTables=function(){var t=[],e=this.databaseTableSection.querySelectorAll("#wpstg_select_tables_cloning option:checked"),n=this.getRegexPattern();return e.forEach((function(e){e.getAttribute("name","").match(n)&&t.push(e.value)})),t.join(this.wpstgObject.settings.directorySeparator)},e.getExcludedTables=function(){var t=[],e=this.databaseTableSection.querySelectorAll("#wpstg_select_tables_cloning option:not(:checked)"),n=this.getRegexPattern();return e.forEach((function(e){e.getAttribute("name","").match(n)&&t.push(e.value)})),t.join(this.wpstgObject.settings.directorySeparator)},e.countSelectedTables=function(){var t=this.input.querySelectorAll("option:checked").length,e=u("#wpstg-tables-count");0===t?(e.classList.add("danger"),e.innerHTML=this.wpstgObject.i18n.noTableSelected):(e.classList.remove("danger"),e.innerHTML=this.wpstgObject.i18n.tablesSelected.replace("{d}",t))},t}(),L=function(){function t(t,e){void 0===t&&(t="#wpstg-exclude-filters-container"),void 0===e&&(e=wpstg),this.excludeContainer=u(t),this.excludeTableBody=u(t+" tbody"),this.wpstgObject=e,this.init()}var e=t.prototype;return e.addEvents=function(){var t=this;p(this.excludeContainer,"click",".wpstg-file-size-rule",(function(){t.addFileSizeExclude()})),p(this.excludeContainer,"click",".wpstg-file-ext-rule",(function(){t.addFileExtExclude()})),p(this.excludeContainer,"click",".wpstg-file-name-rule",(function(){t.addFileNameExclude()})),p(this.excludeContainer,"click",".wpstg-dir-name-rule",(function(){t.addDirNameExclude()})),p(this.excludeContainer,"click",".wpstg-clear-all-rules",(function(){t.clearExcludes()})),p(this.excludeContainer,"click",".wpstg-remove-exclude-rule",(function(e){t.removeExclude(e)}))},e.init=function(){null!==this.excludeContainer?this.addEvents():console.log("Error: Given table selector not found!")},e.addFileSizeExclude=function(){this.addExcludeRuleRow("#wpstg-file-size-exclude-filter-template")},e.addFileExtExclude=function(){this.addExcludeRuleRow("#wpstg-file-ext-exclude-filter-template")},e.addFileNameExclude=function(){this.addExcludeRuleRow("#wpstg-file-name-exclude-filter-template")},e.addDirNameExclude=function(){this.addExcludeRuleRow("#wpstg-dir-name-exclude-filter-template")},e.addExcludeRuleRow=function(t){var e=u(t);if(null!==e){var n=e.content.cloneNode(!0).querySelector("tr");this.excludeTableBody.appendChild(n),d(".wpstg-has-exclude-rules").forEach((function(t){t.style.display="inherit"}))}},e.clearExcludes=function(){this.excludeTableBody.innerHTML="",d(".wpstg-has-exclude-rules").forEach((function(t){t.style.display="none"}))},e.removeExclude=function(t){null!==t.parentElement&&null!==t.parentElement.parentElement&&this.excludeTableBody.removeChild(t.parentElement.parentElement),""===this.excludeTableBody.innerHTML.trim()&&d(".wpstg-has-exclude-rules").forEach((function(t){t.style.display="none"}))},e.getExcludeFilters=function(){for(var t=this,e=[],n=[],o=this.excludeTableBody.querySelectorAll('select[name="wpstgFileSizeExcludeRuleCompare[]"]'),s=this.excludeTableBody.querySelectorAll('input[name="wpstgFileSizeExcludeRuleSize[]"]'),r=this.excludeTableBody.querySelectorAll('select[name="wpstgFileSizeExcludeRuleByte[]"]'),i=0,a=Object.entries(s);i<a.length;i++){var c=a[i],l=c[0],u=c[1];""!==u.value&&n.push(o[l].value+" "+u.value+r[l].value)}this.excludeTableBody.querySelectorAll('input[name="wpstgFileExtExcludeRule[]"]').forEach((function(n){var o=t.cleanStringForGlob(n.value);""!==o&&e.push("ext:"+o.trim())}));for(var d=this.excludeTableBody.querySelectorAll('select[name="wpstgFileNameExcludeRulePos[]"]'),p=this.excludeTableBody.querySelectorAll('input[name="wpstgFileNameExcludeRulePath[]"]'),g=0,h=Object.entries(p);g<h.length;g++){var w=h[g],f=w[0],m=w[1],v=this.cleanStringForGlob(m.value);""!==v&&e.push("file:"+d[f].value+" "+v.trim())}for(var b=this.excludeTableBody.querySelectorAll('select[name="wpstgDirNameExcludeRulePos[]"]'),y=this.excludeTableBody.querySelectorAll('input[name="wpstgDirNameExcludeRulePath[]"]'),x=0,k=Object.entries(y);x<k.length;x++){var S=k[x],E=S[0],C=S[1],T=this.cleanStringForGlob(C.value);""!==T&&e.push("dir:"+b[E].value+" "+T.trim())}return{sizes:n.filter(this.onlyUnique).join(","),globs:e.filter(this.onlyUnique).join(",")}},e.onlyUnique=function(t,e,n){return n.indexOf(t)===e},e.cleanStringForGlob=function(t){return t.replace(/[*^//!\[?]/g,"")},t}(),P=function(){function t(t,e){void 0===e&&(e=wpstg),this.confirmAction=t,this.wpstgObject=e}var e=t.prototype;return e.show=function(t,e,n){var o=this;void 0===e&&(e={}),void 0===n&&(n=null),wpstgSwal.fire(t).then((function(t){t.value&&null!==o.error&&o.triggerConfirmAction(e,n)}))},e.triggerConfirmAction=function(t,e){var n=this;void 0===t&&(t={}),void 0===e&&(e=null),fetch(this.wpstgObject.ajaxUrl,{method:"POST",credentials:"same-origin",body:new URLSearchParams(Object.assign({action:this.confirmAction,accessToken:this.wpstgObject.accessToken,nonce:this.wpstgObject.nonce},t)),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(t){null!==e&&e(t)})).catch((function(t){console.log(n.wpstgObject.i18n.somethingWentWrong,t)}))},t}(),j=function(){function t(t,e,n,o,s){void 0===e&&(e="#wpstg-workflow"),void 0===n&&(n="wpstg_clone_excludes_settings"),void 0===o&&(o="wpstg_modal_error"),void 0===s&&(s=wpstg),this.cloneID=t,this.workflow=u(e),this.wpstgObject=s,this.fetchExcludeSettingsAction=n,this.modalErrorAction=o,this.resetButtonClass="wpstg-confirm-reset-clone",this.resetModalContainerClass="wpstg-reset-confirmation",this.resetTabSelector=".wpstg-reset-exclude-tab",this.directoryNavigator=null,this.excludeFilters=null,this.tableSelector=null,this.isNetworkClone=!1}var e=t.prototype;return e.addEvents=function(){var t=this,e=u("."+this.resetModalContainerClass);null!==e?p(e,"click",this.resetTabSelector,(function(e){t.toggleContent(e)})):console.log("Exit")},e.init=function(){this.addEvents()},e.setNetworkClone=function(t){this.isNetworkClone=t},e.toggleContent=function(t){var e=u("."+this.resetModalContainerClass),n=t.getAttribute("data-id"),o=t.querySelector(".wpstg-tab-triangle"),s=t.getAttribute("data-collapsed","true"),r=u(n);"true"===s?(e.classList.contains("has-collapsible-open")?e.classList.add("has-collapsible-open-2"):e.classList.add("has-collapsible-open"),g(r),o.style.transform="rotate(90deg)",t.setAttribute("data-collapsed","false")):(e.classList.contains("has-collapsible-open-2")?e.classList.remove("has-collapsible-open-2"):e.classList.remove("has-collapsible-open"),h(r),o.style.removeProperty("transform"),t.setAttribute("data-collapsed","true"))},e.showModal=function(){var t=this.loadModal();return this.init(),this.fetchCloneExcludes(),t},e.loadModal=function(){return l.getSwalModal(!1,{confirmButton:this.resetButtonClass+" wpstg-confirm-reset-clone wpstg--btn--confirm wpstg-blue-primary wpstg-button wpstg-link-btn",container:this.resetModalContainerClass+" wpstg-swal2-container wpstg-swal2-loading"}).fire({title:"",icon:"warning",html:this.getAjaxLoader(),width:"400px",focusConfirm:!1,confirmButtonText:this.wpstgObject.i18n.resetClone,showCancelButton:!0})},e.fetchCloneExcludes=function(){var t=this;this.error=null,fetch(this.wpstgObject.ajaxUrl,{method:"POST",credentials:"same-origin",body:new URLSearchParams({action:this.fetchExcludeSettingsAction,accessToken:this.wpstgObject.accessToken,nonce:this.wpstgObject.nonce,clone:this.cloneID,job:"resetting"}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(e){if(e.success){var n=u(".wpstg-reset-confirmation");n.classList.remove("wpstg-swal2-loading"),n.querySelector(".wpstg--swal2-popup").style.width="540px",n.querySelector(".wpstg--swal2-content").innerHTML=e.html,t.directoryNavigator=new T("#wpstg-directories-listing",wpstg,null),t.directoryNavigator.countSelectedFiles(),t.excludeFilters=new L,t.tableSelector=new _("#wpstg-reset-excluded-tables","."+t.resetModalContainerClass),t.tableSelector.setNetworkClone(t.isNetworkClone),t.tableSelector.countSelectedTables()}else{new P(t.modalErrorAction,t.wpstgObject).show(Object.assign({title:"Error",icon:"error",html:t.wpstgObject.i18n.somethingWentWrong,width:"500px",confirmButtonText:"Ok",showCancelButton:!1,customClass:{confirmButton:"wpstg--btn--confirm wpstg-blue-primary wpstg-button wpstg-link-btn",cancelButton:"wpstg--btn--cancel wpstg-blue-primary wpstg-link-btn",actions:"wpstg--modal--actions",popup:"wpstg-swal-popup wpstg-centered-modal"},buttonsStyling:!1,reverseButtons:!0},e.swalOptions),{type:e.type})}})).catch((function(e){t.renderError({html:t.wpstgObject.i18n.somethingWentWrong+" "+e})}))},e.getDirectoryNavigator=function(){return this.directoryNavigator},e.getExcludeFilters=function(){return this.excludeFilters},e.getTableSelector=function(){return this.tableSelector},e.getAjaxLoader=function(){return'<div class="wpstg-swal2-ajax-loader"><img src="'+this.wpstgObject.wpstgIcon+'" /></div>'},t}(),D=function(){function t(t){void 0===t&&(t="#wpstg-clonepage-wrapper"),this.baseContainer=u(t),this.checkBoxSettingTogglerSelector=".wpstg-toggle-advance-settings-section",this.init()}var e=t.prototype;return e.addEvents=function(){var t=this;null!==this.baseContainer&&p(this.baseContainer,"change",this.checkBoxSettingTogglerSelector,(function(e){t.toggleSettings(e)}))},e.init=function(){this.addEvents()},e.toggleSettings=function(t){var e=u("#"+t.getAttribute("data-id"));t.checked?g(e):h(e)},t}(),B=function(){function t(){this.activeTabClass="wpstg--tab--active",this.mainMenu()}return t.prototype.mainMenu=function(){var t=this;if(null!==u(".wpstg--tab--header")){var e=u("#wpstg-workflow");null!==e&&p(e,"click",".wpstg-navigate-button",(function(t){var e=t.getAttribute("data-target");""!==e&&"#wpstg--tab--backup"===e&&u('.wpstg--tab--header a[data-target="#wpstg--tab--backup"]').click()})),p(u(".wpstg--tab--header"),"click",".wpstg-button",(function(e){var n=e,o=n.getAttribute("data-target");if(""!==o){var s=d(o),r=d(".wpstg--tab--header a[data-target]");d(".wpstg--tab--contents > .wpstg--tab--content").forEach((function(e){e.matches("."+t.activeTabClass+":not("+o+")")&&e.classList.remove(t.activeTabClass)})),r.forEach((function(e){e!==n&&e.classList.remove(t.activeTabClass)})),n.classList.add(t.activeTabClass),s.forEach((function(e){e.classList.add(t.activeTabClass)})),"#wpstg--tab--backup"===o&&window.dispatchEvent(new Event("backups-tab"))}}))}},t}(),A=function(t){var e,n=Object.prototype,o=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,o){var r=e&&e.prototype instanceof m?e:m,i=Object.create(r.prototype),a=new j(o||[]);return s(i,"_invoke",{value:T(t,n,a)}),i}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var p="suspendedStart",g="suspendedYield",h="executing",w="completed",f={};function m(){}function v(){}function b(){}var y={};l(y,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(D([])));k&&k!==n&&o.call(k,i)&&(y=k);var S=b.prototype=m.prototype=Object.create(y);function E(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(s,r,i,a){var c=d(t[s],t,r);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&o.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,a)}))}a(c.arg)}var r;s(this,"_invoke",{value:function(t,o){function s(){return new e((function(e,s){n(t,o,e,s)}))}return r=r?r.then(s,s):s()}})}function T(t,e,n){var o=p;return function(s,r){if(o===h)throw new Error("Generator is already running");if(o===w){if("throw"===s)throw r;return B()}for(n.method=s,n.arg=r;;){var i=n.delegate;if(i){var a=_(i,n);if(a){if(a===f)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=w,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var c=d(t,e,n);if("normal"===c.type){if(o=n.done?w:g,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=w,n.method="throw",n.arg=c.arg)}}}function _(t,n){var o=n.method,s=t.iterator[o];if(s===e)return n.delegate=null,"throw"===o&&t.iterator.return&&(n.method="return",n.arg=e,_(t,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),f;var r=d(s,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,f;var i=r.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,f):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function D(t){if(t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,r=function n(){for(;++s<t.length;)if(o.call(t,s))return n.value=t[s],n.done=!1,n;return n.value=e,n.done=!0,n};return r.next=r}}return{next:B}}function B(){return{value:e,done:!0}}return v.prototype=b,s(S,"constructor",{value:b,configurable:!0}),s(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,c,"GeneratorFunction")),t.prototype=Object.create(S),t},t.awrap=function(t){return{__await:t}},E(C.prototype),l(C.prototype,a,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,o,s,r){void 0===r&&(r=Promise);var i=new C(u(e,n,o,s),r);return t.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},E(S),l(S,c,"Generator"),l(S,i,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var o in e)n.push(o);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},t.values=D,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function s(o,s){return a.type="throw",a.arg=t,n.next=o,s&&(n.method="next",n.arg=e),!!s}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),l=o.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&o.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=t,i.arg=e,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var s=o.arg;P(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,o){return this.delegate={iterator:D(t),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=e),f}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=A}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=A:Function("r","regeneratorRuntime = r")(A)}var O=new(function(){function t(){this.wrap="",this.tempHidden="",this.tempHiddenTimeout=""}var e=t.prototype;return e.shows=function(){this.wrap=document.getElementById("wpstg-auth-check-wrap"),this.parentElement=document.getElementById("wpstg-auth-check"),this.formElement=document.getElementById("wpstg-auth-check-form"),this.wrapElement=document.getElementById("wpstg-auth-check-wrap"),this.noFrameElement=this.wrapElement.querySelector(".wpstg-auth-fallback-expired"),this.iframeElement="",this.isIframeLoaded=!1,this.formElement&&(this.addUnloadEvent(),this.iframeElement=this.createIframeElement(),this.formElement.appendChild(this.iframeElement)),this.openModal(),this.iframeElement?(this.focusIframe(),this.setIframeLoadTimeout()):this.focusFallbackElement()},e.addUnloadEvent=function(){window.addEventListener("beforeunload",(function(t){t.returnValue="Your session has expired. You can log in again from this page or go to the login page."}))},e.createIframeElement=function(){var t=this;return this.iframeElement=document.createElement("iframe"),this.iframeElement.id="wpstg-auth-check-frame",this.iframeElement.style.border="0px",this.iframeElement.title=this.noFrameElement.textContent,this.iframeElement.onload=function(){return t.handleIframeLoad()},this.iframeElement.src=this.formElement.dataset.src,this.iframeElement},e.handleIframeLoad=function(){var t,e;this.isIframeLoaded=!0,this.formElement.classList.remove("loading");try{t=(e=this.iframeElement.contentDocument.querySelector("body")).offsetHeight}catch(t){return void this.handleIframeLoadError()}e&&t?e.classList.contains("interim-login-success")?this.hide():this.parentElement.style.maxHeight=t+40+"px":this.handleIframeLoadError()},e.handleIframeLoadError=function(){this.wrapElement.classList.add("fallback"),this.parentElement.style.maxHeight="",this.formElement.remove(),this.noFrameElement.focus()},e.openModal=function(){document.body.classList.add("modal-open"),this.wrapElement.classList.remove("hidden")},e.focusIframe=function(){this.iframeElement.focus()},e.setIframeLoadTimeout=function(){var t=this;setTimeout((function(){t.isIframeLoaded||(t.wrapElement.classList.add("fallback"),t.formElement.remove(),t.noFrameElement.focus())}),2e3)},e.focusFallbackElement=function(){this.noFrameElement.focus()},e.hide=function(){var t,e;window.removeEventListener("beforeunload",(function(t){t.returnValue=null})),t=this.wrap,void 0===(e=200)&&(e=300),t.style.opacity=1,t.style.transitionProperty="opacity",t.style.transitionDuration=e+"ms",setTimeout((function(){t.style.opacity=0,window.setTimeout((function(){t.style.display="none",t.style.removeProperty("opacity"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property")}),e)}),0),M.checkUserAuthentication()},t}()),I=function(){function e(t){void 0===t&&(t=wpstg),this.wpstgObject=t,this.count=0,this.status=!0,this.isAuthenticated=!0}var o=e.prototype;return o.start=function(){var t=this;this.status&&setTimeout((function(){t.checkUserAuthentication()}),1e3)},o.stop=function(){this.resetCount(),this.status=!1},o.resetCount=function(){this.count=0},o.checkUserAuthentication=function(){var e=n(t().mark((function e(){var n=this;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:fetch(this.wpstgObject.ajaxUrl,{method:"POST",credentials:"same-origin",body:new URLSearchParams({action:"wpstg_check_user_is_authenticated",accessToken:this.wpstgObject.accessToken,nonce:this.wpstgObject.nonce}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(t){if(!1===t.wpAuthCheck&&n.count++,n.isAuthenticated=t.wpAuthCheck,2===n.count)return n.stop(),void n.createAuthCheckElements(t.redirectUrl);n.start()})).catch((function(t){console.error("Error:",t)}));case 1:case"end":return t.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.createAuthCheckElements=function(t){null!==document.getElementById("wpstg-auth-check-wrap")&&document.getElementById("wpstg-auth-check-wrap").remove();var e=document.createElement("div");e.id="wpstg-auth-check-wrap",e.classList.add("hidden");var n=document.createElement("div");n.id="wpstg-auth-check-bg";var o=document.createElement("div");o.id="wpstg-auth-check";var s=document.createElement("div");s.id="wpstg-auth-check-form",s.classList.add("loading"),s.dataset.src=t+"?interim-login=1&wp_lang=en_US";var r=document.createElement("div");r.classList.add("wpstg-auth-fallback");var i=document.createElement("p");i.innerHTML='<b class="wpstg-auth-fallback-expired" tabindex="0">Session expired</b>';var a=document.createElement("p");a.innerHTML='<a href="'+t+'" target="_blank">Please log in again.</a> The login page will open in a new tab. After logging in you can close it and return to this page.',o.append(s,r),r.append(i,a),e.append(n,o),document.body.appendChild(e),O.shows()},e}(),M=new I,U=function(){function t(t){void 0===t&&(t=wpstg),this.wpstgObject=t,this.action="",this.isProcessCancelled=!1,this.isProcessFinished=!1,this.processTime=0,this.processInterval="",this.modal=null,this.disableCancelButton=!1,this.title="",this.showCancelButton=!1,this.percentage=0,this.cloneId="",this.successModal="",this.showProcessLogs=!0,this.stagingSiteUrl=""}var e=t.prototype;return e.start=function(){var t=this;(this.showCancelButton=!0,this.processInterval=setInterval((function(){(M.isAuthenticated||"wpstg_push_processing"===t.action)&&(t.processTime++,t.updateElapsedTime())}),1e3),"wpstg_delete_clone"===this.action)&&(y(".wpstg--modal--process--logs--tail"),this.showCancelButton=!1,l.getSwalContainer().querySelector(".wpstg--modal--process--percent").textContent=100);"wpstg_cloning"!==this.action&&"wpstg_push_processing"!==this.action||(M.status=!0,M.start()),y(".wpstg-prev-step-link, #wpstg-start-updating, .wpstg-loader, #wpstg-cancel-cloning, .wpstg-log-details, .wpstg-progress-bar, #wpstg-processing-header"),y(".wpstg-processing-timer, #wpstg-cancel-pushing, .wpstg-progress-bar-wrapper, #wpstg-cancel-cloning-update, #wpstg-removing-clone")},e.stop=function(){this.processTime=0,this.modal=null,this.percentage="",this.resetCancelChecks(),clearInterval(this.processInterval),l.closeSwalModal(),k(),y("#wpstg-try-again, #wpstg-home-link, #wpstg-show-log-button, .wpstg-loader"),"wpstg_cloning"!==this.action&&"wpstg_push_processing"!==this.action||M.stop()},e.resetCancelChecks=function(){var t=this;null!==document.getElementById("wpstg-new-clone")?(setTimeout((function(){t.isProcessCancelled=!1,WPStaging.isCancelled=!1}),2e3),k("hidden")):setTimeout((function(){t.resetCancelChecks()}),1e3)},e.cancelProcess=function(){confirm("Are you sure you want to cancel cloning process?")&&(WPStaging.isCancelled=!0,this.isProcessCancelled=!0,"wpstg_push_processing"===this.action?(l.getSwalContainer().querySelector(".wpstg--modal--process--title").textContent="Canceling Please wait....",this.stop(),x("#wpstg-workflow"),WPStaging.messages=[]):this.cancelCloneAction())},e.setTitle=function(t){this.title=t.job,"database"===t.job||"jobCopyDatabaseTmp"===t.job?(this.title="Copying Database",this.disableCancelButton=!1):"SearchReplace"===t.job?(this.title="Processing Data",this.disableCancelButton=!1):"directories"===t.job||"jobFileScanning"===t.job?(this.title="Scanning Files",this.disableCancelButton=!1):"files"===t.job||"data"===t.job||"jobCopy"===t.job||"jobSearchReplace"===t.job?(this.title="Copying Files",this.disableCancelButton=!1):"Backup"===t.job?(this.title="Backup Files Scanning",this.disableCancelButton=!1):"finish"===t.job||"finished"===t.status?(this.title="Process Finished",this.disableCancelButton=!1):"jobDatabaseRename"===t.job?(this.title="Renaming Database",this.disableCancelButton=!0):"jobData"===t.job&&(this.title="Updating Database Data",this.disableCancelButton=!0)},e.setPercentage=function(t){null!==t.percentage&&(this.percentage=t.percentage)},e.initializeProcessModal=function(){var t=this,e=document.querySelector("#wpstg--modal--backup--process"),n=e.innerHTML;e.parentNode.removeChild(e),this.modal={html:null,cancelBtnTxt:null,processTime:0,instance:l.getSwalModal(!0,{content:"wpstg--process--content"}).fire({html:n,cancelButtonText:"Cancel",showCancelButton:this.showCancelButton,showConfirmButton:!1,showCloseButton:!1,showLoaderOnConfirm:!1,allowEscapeKey:!1,allowOutsideClick:!1,onRender:function(){var e=l.getSwalContainer().getElementsByClassName("wpstg--swal2-cancel wpstg--btn--cancel")[0],n=e.cloneNode(!0);e.parentNode.replaceChild(n,e),n.addEventListener("click",(function(){t.cancelProcess()}))}})},this.start()},e.setProcessModal=function(){var t=l.getSwalContainer(),e=t.getElementsByClassName("wpstg--swal2-cancel wpstg--btn--cancel")[0],n=t.querySelector(".wpstg--modal--process--title"),o=t.querySelector(".wpstg--modal--process--percent");n.textContent=this.title,o.textContent=this.percentage,e.disabled=this.disableCancelButton},e.openProcessModal=function(t,e,n,o){void 0===n&&(n=!1),void 0===o&&(o=!0),this.isProcessCancelled||WPStaging.isCancelled||(void 0!==t&&(this.action=t.action,this.cloneId=t.cloneID),this.showCancelButton=o,this.showLogs=n,this.modal?e.job?(this.setTitle(e),this.setPercentage(e),this.setProcessModal(),"finish"===e.job&&this.stop()):"finished"===e.status&&this.stop():this.initializeProcessModal())},e.formatTimeDuration=function(){return new Date(1e3*this.processTime).toISOString().slice(11,19)+"s"},e.updateElapsedTime=function(){null!==this.processInterval&&(l.getSwalContainer().querySelector(".wpstg--modal--process--elapsed-time").textContent=this.formatTimeDuration())},e.getCancelCloneAction=function(){var t=this;if(""!==this.action)return[{name:"wpstg_cloning",cancel:"wpstg_cancel_clone"},{name:"wpstg_reset",cancel:"wpstg_cancel_update"},{name:"wpstg_update",cancel:"wpstg_cancel_update"},{name:"wpstg_push_processing",cancel:"wpstg_cancel_push_processing"}].find((function(e){return e.name===t.action})).cancel},e.cancelCloneAction=function(){var t=this;this.action&&fetch(this.wpstgObject.ajaxUrl,{method:"POST",credentials:"same-origin",body:new URLSearchParams({action:this.getCancelCloneAction(),accessToken:this.wpstgObject.accessToken,nonce:this.wpstgObject.nonce,clone:this.cloneId}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(e){(e&&void 0!==e.delete&&"finished"===e.delete||!0===e)&&(t.stop(),WPStaging.loadOverview(),WPStaging.messages=[]),!0!==e&&t.cancelCloneAction()})).catch((function(e){console.log(t.wpstgObject.i18n.somethingWentWrong,e)}))},e.initializeSuccessModal=function(t){var e=this;this.successModal=this.setSuccessModalContent(t),l.getSwalModal(!0,{confirmButton:"wpstg--btn--confirm wpstg-green-button wpstg-button wpstg-link-btn wpstg-100-width"}).fire({icon:"success",html:this.successModal.innerHTML,confirmButtonText:"Close",showCancelButton:!1,showConfirmButton:!0,allowOutsideClick:!1}).then((function(t){t.value&&(l.closeSwalModal(),y(".wpstg-loader"),WPStaging.messages=[],"wpstg_push_processing"===e.action&&location.reload(),e.action="")})),this.showProcessLogs&&x(".wpstg--modal--download--logs--wrapper"),y(".wpstg-loader"),"wpstg_delete_clone"!==this.action&&WPStaging.loadOverview()},e.setSuccessModalContent=function(t){var e=document.getElementById("wpstg--modal--backup--download");if(null!==t.title&&(e.innerHTML=e.innerHTML.replace("{title}",t.title)),this.showProcessLogs&&(e.innerHTML=e.innerHTML.replace("{btnTxtLog}",'<span style="text-decoration: underline">Show Logs</span>')),null!==t.body&&void 0!==t.body){var n=t.body;null!==this.stagingSiteUrl&&(n+='<br><strong><a href="'+this.stagingSiteUrl+'" target="_blank" id="wpstg-clone-url">'+this.stagingSiteUrl+"</a></strong>"),e.innerHTML=e.innerHTML.replace("{text}",n)}else e.innerHTML=e.innerHTML.replace("{text}","");return e},e.openSuccessModal=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.stagingSiteUrl=n,this.showProcessLogs=e,this.initializeSuccessModal(t)},t}();new(function(){function t(t){void 0===t&&(t=wpstg),this.wpstgObject=t,this.wpstgBackupNoticeCloseButton=null,this.wpstgBackupNoticeReminderButton=null,this.init()}var e=t.prototype;return e.init=function(){var t=this;document.addEventListener("DOMContentLoaded",(function(){t.wpstgBackupNoticeCloseButton=document.getElementById("wpstg-backup-plugin-notice-close"),t.wpstgBackupNoticeReminderButton=document.getElementById("wpstg-backup-plugin-notice-remind-me"),t.addEvent()}))},e.addEvent=function(){var t=this;null!==this.wpstgBackupNoticeCloseButton&&this.wpstgBackupNoticeCloseButton.addEventListener("click",(function(){t.closeBackupPluginNotice()})),null!==this.wpstgBackupNoticeReminderButton&&this.wpstgBackupNoticeReminderButton.addEventListener("click",(function(){t.closeBackupPluginNotice("wpstg_backup_plugin_notice_remind_me")}))},e.closeBackupPluginNotice=function(t){void 0===t&&(t="wpstg_backup_plugin_notice_close"),fetch(this.wpstgObject.ajaxUrl,{method:"POST",credentials:"same-origin",body:new URLSearchParams({action:t,nonce:this.wpstgObject.nonce}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){if(t.ok)return t.json()})).then((function(t){t.success&&(u(".wpstg-backup-plugin-notice-container").style.opacity=0)})).catch((function(t){u(".wpstg-backup-plugin-notice-container").style.opacity=0}))},t}());var q=function(e){var s={isCancelled:!1,isFinished:!1,getLogs:!1,time:1,executionTime:!1,progressBar:0,cloneExcludeFilters:null,directoryNavigator:null,tableSelector:null,notyf:null,areAllTablesChecked:!0,handleDisplayDependencies:f,handleToggleElement:m,handleCopyPaste:v,handleCopyToClipboard:b,messages:[],requestType:"",modal:{instance:"",processTime:0,processInterval:"",currentJob:""}};s.wpstgProcessModal=new U;var r,i={elements:[]};i.get=function(t){return-1!==e.inArray(t,i.elements)||(i.elements[t]=jQuery(t)),i.elements[t]},i.refresh=function(t){t.elements[t]=jQuery(t)};var a=function(t){i.get("#wpstg-try-again").css("display","inline-block"),i.get("#wpstg-cancel-cloning").text("Reset"),i.get("#wpstg-resume-cloning").show(),i.get("#wpstg-error-wrapper").show(),i.get("#wpstg-error-details").show().html(t),i.get(".wpstg-loading-bar-container").css("visibility","hidden"),i.get(".wpstg-loader").hide(),e(".wpstg--modal--process--generic-problem").show().html(t),e.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"wpstg_staging_job_error",accessToken:wpstg.accessToken,nonce:wpstg.nonce,error_message:t}})};s.warnIfClosingDuringProcess=function(t){return t.returnValue="You MUST leave this window open while cloning/pushing. Please wait...",null};var c=function(t,e,n){return e=e?e+"<br/><br/>":"Something went wrong! <br/><br/>",n=n?n+"<br/><br/>":"<br/><br/>Please try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.",!1===t?(a(e+" Error: No response."+n),void window.removeEventListener("beforeunload",q.warnIfClosingDuringProcess)):void 0!==t.error&&t.error?(console.error(t.message),a(e+" Error: "+t.message+n),void window.removeEventListener("beforeunload",q.warnIfClosingDuringProcess)):void 0},u=function(){i.get("#wpstg-error-details").hide().html("")},d=function(){var t=e("#wpstg_clone_hostname").val();if(""===t)return!0;return!1!==/^http(s)?:\/\/.*$/.test(t)},p=function(){var t=i.get("#wpstg-workflow");t.on("click","#wpstg-cancel-cloning",(function(){if(!confirm("Are you sure you want to cancel cloning process?"))return!1;var t=e(this);e("#wpstg-try-again, #wpstg-home-link").hide(),t.prop("disabled",!0),s.isCancelled=!0,s.progressBar=0,e("#wpstg-processing-status").text("Please wait...this can take up a while."),e(".wpstg-loader, #wpstg-show-log-button").hide(),t.parent().append(r),M()})).on("click","#wpstg-resume-cloning",(function(){u();var t=e(this);e("#wpstg-try-again, #wpstg-home-link").hide(),s.isCancelled=!1,e("#wpstg-processing-status").text("Try to resume cloning process..."),e("#wpstg-error-details").hide(),e(".wpstg-loader").show(),t.parent().append(r),s.startCloning()})).on("click","#wpstg-cancel-cloning-update",(function(){u();var t=e(this);e("#wpstg-try-again, #wpstg-home-link").hide(),t.prop("disabled",!0),s.isCancelled=!0,e("#wpstg-cloning-result").text("Please wait...this can take up a while."),e(".wpstg-loader, #wpstg-show-log-button").hide(),t.parent().append(r),R()})).on("click","#wpstg-restart-cloning",(function(){u();var t=e(this);e("#wpstg-try-again, #wpstg-home-link").hide(),t.prop("disabled",!0),s.isCancelled=!0,e("#wpstg-cloning-result").text("Please wait...this can take up a while."),e(".wpstg-loader, #wpstg-show-log-button").hide(),t.parent().append(r),N()})).on("click",".wpstg-remove-clone[data-clone]",(function(n){u(),n.preventDefault(),t.removeClass("active"),i.get(".wpstg-loader").show();var o=e(this).data("clone"),r=e(this).data("name");g({action:"wpstg_confirm_delete_clone",accessToken:wpstg.accessToken,nonce:wpstg.nonce,clone:e(this).data("clone")},(function(t){l.getSwalModal(!0,{popup:"wpstg-swal-popup wpstg-centered-modal wpstg-delete-staging-site-modal",content:"wpstg--process--content"}).fire({title:'Delete staging site "'+r+'"',icon:"error",html:t,width:"100%",focusConfirm:!1,confirmButtonText:"Delete",confirmButtonColor:"#e01e5a",showCancelButton:!0,onRender:function(){var t=document.getElementById("wpstg-unselect-all-tables"),e=document.getElementById("wpstg-unselect-all-tables-id");null!==t&&t.addEventListener("click",(function(t){!1===s.areAllTablesChecked?(i.get("#wpstg_select_tables_cloning .wpstg-db-table").prop("selected","selected"),i.get("#wpstgUnselectAllTablesId").text("Unselect All"),e.textContent="Unselect All",i.get(".wpstg-db-table-checkboxes").prop("checked",!0),s.areAllTablesChecked=!0):(i.get("#wpstg_select_tables_cloning .wpstg-db-table").prop("selected",!1),i.get("#wpstgUnselectAllTablesId").text("Select All"),e.textContent="Select All",i.get(".wpstg-db-table-checkboxes").prop("checked",!1),s.areAllTablesChecked=!1)})),document.querySelector(".wpstg--swal2-html-container").classList.remove("wpstg--swal2-html-container"),document.querySelector(".wpstg--swal2-confirm").style.background="#e01e5a",document.querySelector(".wpstg--swal2-x-mark-line-left").style.background="#e01e5a",document.querySelector(".wpstg--swal2-x-mark-line-right").style.background="#e01e5a",document.querySelector(".wpstg--swal2-icon.wpstg--swal2-error").style.borderColor="#e01e5a";var n=l.getSwalContainer().getElementsByClassName("wpstg--swal2-cancel wpstg--btn--cancel")[0],o=n.cloneNode(!0);n.parentNode.replaceChild(o,n),o.addEventListener("click",(function(t){l.closeSwalModal(),s.modal.instance=null,i.get(".wpstg-loader").removeClass("wpstg-finished"),i.get(".wpstg-loader").hide()}))}}).then((function(t){if(t.value){var n=document.querySelector("#deleteDirectory:checked"),r="",i=[];null!==n&&(r=n.getAttribute("data-deletepath")),e(".wpstg-db-table input:not(:checked)").each((function(){i.push(this.name)})),s.modal.instance=null;s.wpstgProcessModal.openProcessModal({action:"wpstg_delete_clone",cloneID:o},{job:"delete"},!1,!1),I(o,r,i)}}))}),"HTML")})).on("click","#wpstg-remove-clone",(function(t){u(),t.preventDefault(),i.get(".wpstg-loader").show(),I(e(this).data("clone"))})).on("click","#wpstg-cancel-removing",(function(t){t.preventDefault(),e(".wpstg-clone").removeClass("active"),i.get("#wpstg-removing-clone").html("")})).on("click",".wpstg-execute-clone",(function(n){n.preventDefault();var o=e(this).data("clone");s.cloneExcludeFilters=null,g({action:"wpstg_scanning",clone:o,accessToken:wpstg.accessToken,nonce:wpstg.nonce},(function(e){e.length<1&&a("Something went wrong! Error: No response.  Please try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report and contact us.");var n=E(e);!1===n||!1!==n.success?(t.html(e),W(),s.directoryNavigator=new T("#wpstg-directories-listing",wpstg,s.notyf),s.directoryNavigator.countSelectedFiles(),s.tableSelector=new _("#wpstg-scanning-db","#wpstg-workflow","#wpstg_network_clone","#wpstg_select_tables_cloning",wpstg,s.notyf),s.tableSelector.countSelectedTables(),s.cloneExcludeFilters=new L,s.switchStep(2)):S(n)}),"HTML")})).on("click","#wpstg-update-cloning-site-button",(function(t){window.open(s.data.cloneHostname,"_blank")})).on("click",".wpstg-reset-clone",(function(t){t.preventDefault();var n=e(this).data("clone"),o=new j(n);o.setNetworkClone("yes"===e(this).data("network"));var r=o.showModal();s.areAllTablesChecked=!0,r.then((function(t){if(t.value){var e=o.getDirectoryNavigator(),s=o.getTableSelector(),r=o.getExcludeFilters().getExcludeFilters(),i="",a="",c="",l=!1;null!==s&&(i=s.getIncludedTables(),a=s.getExcludedTables(),c=s.getSelectedTablesWithoutPrefix()),i.length>a.length?i="":a.length>i.length&&(a="",l=""===i),A(n,{includedTables:i,excludedTables:a,allTablesExcluded:l,selectedTablesWithoutPrefix:c,excludeSizeRules:encodeURIComponent(r.sizes),excludeGlobRules:encodeURIComponent(r.globs),excludedDirectories:e.getExcludedDirectories(),extraDirectories:e.getExtraDirectoriesRootOnly()})}}))}))},g=function o(s,r,c,u,d,p){void 0===p&&(p=null),void 0===c&&(c="json"),!1!==u&&(u=!0);var g=1e4*(d=void 0===d?0:d);p=parseInt(p),isNaN(p)||(g*=p);var h,w="Please try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP STAGING Small Server Settings</a> or submit an error report and contact us. <br/><br/><strong>Tip:</strong> If you get this error while pushing, you can also use the <strong>BACKUP & MIGRATION</strong> feature to move your staging site to live. <a href='https://wp-staging.com/docs/how-to-migrate-your-wordpress-site-to-a-new-host/' target='_blank'>Read more.</a>";e.ajax({url:ajaxurl+"?action=wpstg_processing&_="+Date.now()/1e3,type:"POST",dataType:c,cache:!1,data:s,error:(h=n(t().mark((function e(n,h,f){var m,v,b;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("wpstg_cloning"!==q.requestType){t.next=13;break}return t.next=3,l.checkMemoryExhaustion(q.requestType);case 3:if(m=t.sent,v='<br/><br/><button class="wpstg-btn wpstg-primary-btn wpstg-report-issue-button" type="button">CONTACT US</button> for help in solving this issue.',wpstg.isPro&&(v='<br/><br/>Read <a target="_blank" href="'+l.memoryExhaustArticleLink+'">this article</a> for solving this issue.<br/><br/>Please contact WP Staging support if you need further assistance.'),!1===m){t.next=13;break}return window.removeEventListener("beforeunload",q.warnIfClosingDuringProcess),q.requestType="",i.get(".wpstg-loader").hide(),O(),l.showErrorModal(m.message+"."+v),t.abrupt("return");case 13:++d<=5?(console.log("RETRYING "+d+"/5"),setTimeout((function(){o(s,r,c,u,d,p)}),g)):(q.requestType="",console.log("RETRYING LIMIT"),b=void 0===n.status?"Unknown":n.status,a("Fatal Error:  "+b+" "+w));case 15:case"end":return t.stop()}}),e)}))),function(t,e,n){return h.apply(this,arguments)}),success:function(t){"function"==typeof r&&r(t)},statusCode:{404:function(){d>=5&&a("Error 404 - Can't find ajax request URL! "+w)},500:function(){d>=5&&a("Fatal Error 500 - Internal server error while processing the request! "+w)},504:function(){d>5&&a("Error 504 - It seems your server is rate limiting ajax requests. Please try to resume after a minute. "+w)},502:function(){d>=5&&a("Error 502 - It seems your server is rate limiting ajax requests. Please try to resume after a minute. "+w)},503:function(){d>=5&&a("Error 503 - It seem your server is rate limiting ajax requests. Please try to resume after a minute. "+w)},429:function(){d>=5&&a("Error 429 - It seems your server is rate limiting ajax requests. Please try to resume after a minute. "+w)},403:function(){d>=5&&a("Refresh page or login again! The process should be finished successfully. \n ")},400:function(){d>=5&&a("Error 400: <strong>It looks like you have been logged out.</strong><br/><br/> <a href='/wp-login.php' target='_blank' id=\"wpstg-login-link\">Log in again and try again!</a>")}}})},h=function(t,e){i.get(".wpstg-loader").show(),g({action:"wpstg_database_verification",accessToken:wpstg.accessToken,nonce:wpstg.nonce,databaseUser:i.get("#wpstg_db_username").val(),databasePassword:i.get("#wpstg_db_password").val(),databaseServer:i.get("#wpstg_db_server").val(),databaseDatabase:i.get("#wpstg_db_database").val(),databaseSsl:i.get("#wpstg_db_ssl").is(":checked")},(function(n){if(!1===n)return a("Something went wrong! Error: No response.Please try again. If that does not help, <a href='https://wp-staging.com/support/' target='_blank'>open a support ticket</a> "),void i.get(".wpstg-loader").hide();if(void 0===n.success)return a("Something went wrong! Error: Invalid response.Please try again. If that does not help, <a href='https://wp-staging.com/support/' target='_blank'>open a support ticket</a> "),void i.get(".wpstg-loader").hide();if(n.success)return i.get(".wpstg-loader").hide(),void w(t,e);if("comparison"===n.error_type){i.get(".wpstg-loader").hide();var o='<table class="wpstg-db-comparison-table"><thead><tr><th>Property</th><th>Production DB</th><th>Staging DB</th><th>Status</th></tr></thead><tbody>';return n.checks.forEach((function(t){var e='<span class="wpstg-css-tick"></span>';t.production!==t.staging&&(e='<span class="wpstg-css-cross"></span>'),o+="<tr><td>"+t.name+"</td><td>"+t.production+"</td><td>"+t.staging+"</td><td>"+e+"</td></tr>"})),o+="</tbody></table><p>Note: Some MySQL/MariaDB properties do not match. You may proceed but the staging site may not work as expected.</p>",void l.getSwalModal(!0,{popup:"wpstg-swal-popup wpstg-db-comparison-modal wpstg-centered-modal"}).fire({title:"Different Database Properties",icon:"warning",html:o,width:"650px",focusConfirm:!1,confirmButtonText:"Proceed",showCancelButton:!0}).then((function(n){n.value&&w(t,e)}))}l.getSwalModal(!0).fire({title:"Different Database Properties",icon:"error",html:n.message,focusConfirm:!0,confirmButtonText:"Ok",showCancelButton:!1}),i.get(".wpstg-loader").hide()}),"json",!1)},w=function(t,n){"wpstg_cloning"===t.data("action")?new Promise((function(t){g({action:"wpstg_is_writable_clone_destination_dir",accessToken:wpstg.accessToken,nonce:wpstg.nonce,cloneDir:e("#wpstg_clone_dir").val()},(function(e){var n;e.success?(i.get(".wpstg-loader").hide(),t(!0)):(a("Something went wrong! Error: "+(null==(n=e.data)?void 0:n.message)),i.get(".wpstg-loader").hide(),document.getElementById("wpstg-error-wrapper").scrollIntoView(),t(!1))}),"json",!1)})).then((function(e){e&&y(t,n)})):y(t,n)},y=function(t,n){i.get(".wpstg-loading-bar-container").css("visibility","visible"),s.data={action:t.data("action"),accessToken:wpstg.accessToken,nonce:wpstg.nonce},function(){if("wpstg_cloning"===s.data.action||"wpstg_update"===s.data.action||"wpstg_reset"===s.data.action){if(s.data.cloneID=(new Date).getTime().toString(),"wpstg_update"===s.data.action&&(s.data.cloneID=e("#wpstg-new-clone-id").data("clone")),s.data.cloneName=e("#wpstg-new-clone-id").val()||s.data.cloneID,null!==s.directoryNavigator&&(s.data.excludedDirectories=encodeURIComponent(s.directoryNavigator.getExcludedDirectories()),s.data.extraDirectories=encodeURIComponent(s.directoryNavigator.getExtraDirectoriesRootOnly())),s.data.excludeGlobRules="",s.data.excludeSizeRules="",s.cloneExcludeFilters instanceof L){var t=s.cloneExcludeFilters.getExcludeFilters();s.data.excludeGlobRules=encodeURIComponent(t.globs),s.data.excludeSizeRules=encodeURIComponent(t.sizes)}s.data.includedTables="",s.data.excludedTables="",s.data.allTablesExcluded=!1,null!==s.tableSelector&&(s.data.includedTables=s.tableSelector.getIncludedTables(),s.data.excludedTables=s.tableSelector.getExcludedTables(),s.data.selectedTablesWithoutPrefix=s.tableSelector.getSelectedTablesWithoutPrefix()),s.data.includedTables.length>s.data.excludedTables.length?s.data.includedTables="":s.data.excludedTables.length>s.data.includedTables.length&&(s.data.excludedTables="",s.data.allTablesExcluded=""===s.data.includedTables),s.data.databaseServer=e("#wpstg_db_server").val(),s.data.databaseUser=e("#wpstg_db_username").val(),s.data.databasePassword=e("#wpstg_db_password").val(),s.data.databaseDatabase=e("#wpstg_db_database").val(),s.data.databasePrefix=e("#wpstg_db_prefix").val(),s.data.databaseSsl=e("#wpstg_db_ssl").is(":checked");var n=e("#wpstg_clone_dir").val();s.data.cloneDir=encodeURIComponent(e.trim(n)),s.data.cloneHostname=e("#wpstg_clone_hostname").val(),s.data.cronDisabled=e("#wpstg_disable_cron").is(":checked"),s.data.emailsAllowed=e("#wpstg_allow_emails").is(":checked"),s.data.networkClone=e("#wpstg_network_clone").is(":checked"),s.data.uploadsSymlinked=e("#wpstg_symlink_upload").is(":checked"),s.data.cleanPluginsThemes=e("#wpstg-clean-plugins-themes").is(":checked"),s.data.cleanUploadsDir=e("#wpstg-clean-uploads").is(":checked")}}(),x(n)},x=function(t){var e=i.get(".wpstg-loading-bar-container");g(s.data,(function(n){!1===n&&a("Something went wrong!<br/><br/> Go to WP Staging > Settings and lower 'File Copy Limit' and 'DB Query Limit'. Also set 'CPU Load Priority to low 'and try again. If that does not help, <a href='https://wp-staging.com/support/' target='_blank'>open a support ticket</a> "),n.length<1&&(e.css("visibility","hidden"),a("Something went wrong! No response.  Go to WP Staging > Settings and lower 'File Copy Limit' and 'DB Query Limit'. Also set 'CPU Load Priority to low 'and try again. If that does not help, <a href='https://wp-staging.com/support/' target='_blank'>open a support ticket</a> "));var o=E(n);if(!1!==o&&!1===o.success)return e.css("visibility","hidden"),void S(o);e.css("visibility","hidden"),t.html(n),s.cloneExcludeFilters=null,"wpstg_scanning"===s.data.action?(s.areAllTablesChecked=!0,s.directoryNavigator=new T("#wpstg-directories-listing",wpstg,s.notyf),s.tableSelector=new _("#wpstg-scanning-db","#wpstg-workflow","#wpstg_network_clone","#wpstg_select_tables_cloning",wpstg),s.switchStep(2),s.cloneExcludeFilters=new L,s.directoryNavigator.countSelectedFiles(),s.tableSelector.countSelectedTables()):"wpstg_cloning"!==s.data.action&&"wpstg_update"!==s.data.action&&"wpstg_reset"!==s.data.action||s.switchStep(3),s.startCloning()}),"HTML")},S=function(t){new P("wpstg_modal_error",wpstg).show(Object.assign({title:"Error",icon:"error",html:wpstg.i18n.somethingWentWrong+(void 0!==t.message?"<br/>"+t.message:""),width:"500px",confirmButtonText:"Ok",showCancelButton:!1,customClass:{confirmButton:"wpstg--btn--confirm wpstg-blue-primary wpstg-button wpstg-link-btn",cancelButton:"wpstg--btn--cancel wpstg-blue-primary wpstg-link-btn",actions:"wpstg--modal--actions",popup:"wpstg-swal-popup wpstg-centered-modal"},buttonsStyling:!1,reverseButtons:!0},t.swalOptions),{type:t.type})},E=function(t){if(!t)return!1;try{var e=JSON.parse(t);if(e&&"object"==typeof e)return e}catch(t){}return!1},A=function(t,e){s.data={action:"wpstg_reset",accessToken:wpstg.accessToken,nonce:wpstg.nonce,cloneID:t},s.data=o({},s.data,e);var n=i.get("#wpstg-workflow");x(n)},O=function(){var t=i.get("#wpstg-workflow"),e=i.get(".wpstg-loading-bar-container");e.css("visibility","visible"),g({action:"wpstg_overview",accessToken:wpstg.accessToken,nonce:wpstg.nonce},(function(n){n.length<1&&a("Something went wrong! No response. Please try the <a href='https://wp-staging.com/docs/wp-staging-settings-for-small-servers/' target='_blank'>WP Staging Small Server Settings</a> or submit an error report."),i.get(".wpstg-current-step"),e.css("visibility","hidden"),t.html(n)}),"HTML"),s.switchStep(1),i.get(".wpstg-step3-cloning").show(),i.get(".wpstg-step3-pushing").hide()},I=function t(n,o,r){g({action:"wpstg_delete_clone",clone:n,accessToken:wpstg.accessToken,nonce:wpstg.nonce,excludedTables:r,deleteDir:o},(function(a){if(!a||(c(a),void 0===a.delete||"finished"!==a.delete&&"unfinished"!==a.delete))!0===a||t(n,o,r);else if("finished"===a.delete&&void 0===a.error&&e('.wpstg-clone[data-clone-id="'+n+'"]').remove(),e("#wpstg-existing-clones .wpstg-clone").length<1&&(i.get("#wpstg-existing-clones").find("h3").text(""),i.get("#wpstg-no-staging-site-results").show()),i.get(".wpstg-loader").hide(),null!==wpstg.i18n.wpstg_delete_clone&&"finished"===a.delete){s.wpstgProcessModal.openProcessModal({action:"wpstg_delete_clone",cloneID:n},{status:"finished"},!1,!1),l.getSwalModal(!0,{confirmButton:"wpstg--btn--confirm wpstg-green-button wpstg-button wpstg-link-btn wpstg-100-width"}).fire({icon:"success",html:'<div style="display:block"><h2 style="color: #565656;">'+wpstg.i18n.wpstg_delete_clone.title+"</h2></div>",confirmButtonText:"Close",showCancelButton:!1,showConfirmButton:!0}).then((function(t){t.value&&(l.closeSwalModal(),k("hidden"))}))}}))},M=function t(){if(s.timer("stop"),!0===s.isFinished)return!0;g({action:"wpstg_cancel_clone",clone:s.data.cloneID,accessToken:wpstg.accessToken,nonce:wpstg.nonce},(function(e){if(e&&void 0!==e.delete&&"finished"===e.delete)return i.get(".wpstg-loader").hide(),void O();!0===e?O():t()}))},R=function t(){if(!0===s.isFinished)return!0;g({action:"wpstg_cancel_update",clone:s.data.cloneID,accessToken:wpstg.accessToken,nonce:wpstg.nonce},(function(e){e&&void 0!==e.delete&&"finished"===e.delete||!0===e?O():t()}))},N=function(){if(!0===s.isFinished)return!0;g({action:"wpstg_restart",accessToken:wpstg.accessToken,nonce:wpstg.nonce},(function(t){t&&void 0!==t.delete&&"finished"===t.delete||!0===t?O():R()}))},F=function(t){if(Array.isArray(t))t.forEach((function(t){if(null!==t&&!s.messages.find((function(e){return e.message===t.message}))){s.messages.push(t);var n=e(".wpstg--modal--process--logs"),o="wpstg--modal--process--msg--"+(t.type.toLowerCase()||"info");n.append('<p class="'+o+'">['+(t.type||"info")+"] - ["+t.date+"] - "+t.message+"</p>")}}));else if(!s.messages.find((function(e){return e.message===t.message}))){s.messages.push(t);var n=e(".wpstg--modal--process--logs"),o="wpstg--modal--process--msg--"+(t.type.toLowerCase()||"info");n.append('<p class="'+o+'">['+(t.type||"info")+"] - ["+t.date+"] - "+t.message+"</p>")}document.querySelectorAll(".wpstg--modal--process--logs").forEach((function(t){t.scrollTop=t.scrollHeight}))},W=function(){i.get("#wpstg-check-space").on("click",(function(t){i.get(".wpstg-loader").show();var e=encodeURIComponent(s.directoryNavigator.getExcludedDirectories()),n=encodeURIComponent(s.directoryNavigator.getExtraDirectoriesRootOnly());g({action:"wpstg_check_disk_space",accessToken:wpstg.accessToken,nonce:wpstg.nonce,excludedDirectories:e,extraDirectories:n},(function(t){if(!1===t)return i.get("#wpstg-clone-id-error").text("Can not detect required disk space").show(),void i.get(".wpstg-loader").hide();i.get("#wpstg-clone-id-error").html("<strong>Estimated necessary disk space: "+t.requiredSpace+"</strong>"+(null!==t.errorMessage?"<br>"+t.errorMessage:"")+'<br> <span style="color:#444;">Before you proceed ensure your account has enough free disk space to hold the entire instance of the production site. You can check the available space from your hosting account (e.g. cPanel).</span>').show(),i.get(".wpstg-loader").hide()}),"json",!1)}))};return s.timer=function(t){if("stop"===t){var e=s.time;return s.time=1,clearInterval(s.executionTime),s.convertSeconds(e)}s.executionTime=setInterval((function(){null!==document.getElementById("wpstg-processing-timer")&&(document.getElementById("wpstg-processing-timer").innerHTML="Elapsed Time: "+s.convertSeconds(s.time)),s.time++,"stop"===t&&(s.time=1,clearInterval(s.executionTime))}),1e3)},s.convertSeconds=function(t){var e=new Date(null);return e.setSeconds(t),e.toISOString().substr(11,8)},s.startCloning=function(){if(u(),W(),"wpstg_cloning"===s.data.action||"wpstg_update"===s.data.action||"wpstg_reset"===s.data.action){s.isCancelled=!1,i.get(".wpstg-loader").show(),i.get("#wpstg-cancel-cloning").text("Cancel"),i.get("#wpstg-resume-cloning").hide(),i.get("#wpstg-error-details").hide(),setTimeout((function(){window.addEventListener("beforeunload",q.warnIfClosingDuringProcess),t()}),wpstg.delayReq);var t=function t(){if(!0===s.isCancelled)return window.removeEventListener("beforeunload",q.warnIfClosingDuringProcess),!1;var o;(o=!0)&&!1!==o?i.get(".wpstg-loader").show():i.get(".wpstg-loader").hide();var r,a="",l="";null!==s.directoryNavigator&&(a=s.directoryNavigator.getExcludedDirectories(),l=s.directoryNavigator.getExtraDirectoriesRootOnly()),q.requestType="wpstg_cloning",q.ajax({action:"wpstg_processing",accessToken:wpstg.accessToken,nonce:wpstg.nonce,excludedTables:(r=[],e(".wpstg-db-table input:not(:checked)").each((function(){r.push(this.name)})),r),excludedDirectories:encodeURIComponent(a),extraDirectories:encodeURIComponent(l)},(function(e){c(e),void 0!==e.last_msg&&e.last_msg&&F(e.last_msg),!1===e.status?(n(e),setTimeout((function(){t()}),wpstg.delayReq)):!0===e.status&&"finished"!==e.status?(i.get("#wpstg-error-details").hide(),i.get("#wpstg-error-wrapper").hide(),n(e),t()):("finished"===e.status||void 0!==e.job_done&&e.job_done)&&(window.removeEventListener("beforeunload",q.warnIfClosingDuringProcess),q.requestType="",function(t){!0===s.getLogs&&F();n(t),void 0!==t.last_msg&&F(t.last_msg);null!==wpstg.i18n[s.data.action]&&s.wpstgProcessModal.openSuccessModal(wpstg.i18n[s.data.action],!0,t.url)}(e))}),"json",!1)},n=function(t,e){null!==t&&s.wpstgProcessModal.openProcessModal(s.data,t,!0)}}},s.switchStep=function(t){i.get(".wpstg-current-step").removeClass("wpstg-current-step"),i.get(".wpstg-step"+t).addClass("wpstg-current-step")},s.checkUserDbPermissions=function(t){return new Promise((function(n){q.ajax({action:"wpstg_check_user_permissions",accessToken:wpstg.accessToken,nonce:wpstg.nonce,type:t},(function(t){t.success?n(!0):(l.getSwalModal(!0,{container:"wpstg-swal-push-container"}).fire({title:"",icon:"warning",html:t.data.message,width:"750px",focusConfirm:!1,confirmButtonText:"Proceed",showCancelButton:!0}).then((function(t){t.isConfirmed&&n(!0)})),e("#wpstg-db-permission-show-full-message").click((function(){e("#wpstg-permission-info-output").html(e("#wpstg-permission-info-data").html())})))}),"json",!1)}))},s.init=function(){var t,n,o;O(),n=i.get("#wpstg-workflow"),o=ajaxurl.replace("/admin-ajax.php","")+"/images/spinner",2<window.devicePixelRatio&&(o+="-2x"),r="<img src=''"+(o+=".gif")+"' alt='' class='ajax-spinner general-spinner' />",n.on("click",".wpstg-button-unselect",(function(t){t.preventDefault(),!1===s.areAllTablesChecked?(i.get("#wpstg_select_tables_cloning .wpstg-db-table").prop("selected","selected"),i.get(".wpstg-button-unselect").text("Unselect All"),i.get(".wpstg-db-table-checkboxes").prop("checked",!0),s.areAllTablesChecked=!0):(i.get("#wpstg_select_tables_cloning .wpstg-db-table").prop("selected",!1),i.get(".wpstg-button-unselect").text("Select All"),i.get(".wpstg-db-table-checkboxes").prop("checked",!1),s.areAllTablesChecked=!1)})).on("keyup","#wpstg-new-clone-id",(function(){if(document.getElementById("wpstg-error-details").style.display="none","number"==typeof t&&clearInterval(t),void 0===this.value||""===this.value)return i.get("#wpstg-new-clone-id").removeClass("wpstg-error-input"),i.get("#wpstg-start-cloning").removeAttr("disabled"),void i.get("#wpstg-clone-id-error").text("").hide();var e=l.slugify(this.value);t=setTimeout((function(){g({action:"wpstg_check_clone",accessToken:wpstg.accessToken,nonce:wpstg.nonce,directoryName:e},(function(t){"success"===t.status?(i.get("#wpstg-new-clone-id").removeClass("wpstg-error-input"),i.get("#wpstg-start-cloning").removeAttr("disabled"),i.get("#wpstg-clone-id-error").text("").hide()):(i.get("#wpstg-new-clone-id").addClass("wpstg-error-input"),i.get("#wpstg-start-cloning").prop("disabled",!0),i.get("#wpstg-clone-id-error").text(t.message).show())}))}),500)})).on("click","#wpstg-start-cloning",(function(){u(),s.isCancelled=!1,s.progressBar=0})).on("input","#wpstg-new-clone-id",(function(){if(!(e("#wpstg-clone-directory").length<1)){var t=l.slugify(this.value).substring(0,16),n=e("#wpstg-use-target-dir"),o=e("#wpstg-use-target-hostname"),s=n.data("base-path"),r=o.data("base-uri");s&&(s=s.replace(/\/+$/g,"")+"/"+t+"/"),r&&(r=r.replace(/\/+$/g,"")+"/"+t),e(".wpstg-use-target-dir--value").text(s),e(".wpstg-use-target-hostname--value").text(r),n.attr("data-path",s),o.attr("data-uri",r),e("#wpstg_clone_dir").attr("placeholder",s),e("#wpstg_clone_hostname").attr("placeholder",r)}})).on("input","#wpstg_clone_hostname",(function(){""===e(this).val()||d()?e("#wpstg_clone_hostname_error").remove():d()||e("#wpstg_clone_hostname_error").length||e("#wpstg-clone-directory tr:last-of-type").after('<tr><td>&nbsp;</td><td><p id="wpstg_clone_hostname_error" style="color: red;">&nbsp;Invalid host name. Please provide it in a format like http://example.com</p></td></tr>')})),p(),function(){var t=i.get("#wpstg-workflow");t.on("click",".wpstg-next-step-link",(function(n){n.preventDefault();var o=e(this);if(e("#wpstg_clone_hostname").length&&!d())return e("#wpstg_clone_hostname").focus(),!1;if(("wpstg_update"===o.data("action")||"wpstg_reset"===o.data("action"))&&"wpstg_update"===o.data("action")){var s=o,r=t,i=o.data("action");return l.getSwalModal(!1,{popup:"wpstg-update-staging-site-modal wpstg-swal-popup wpstg-centered-modal",content:"wpstg--process--content"}).fire({title:"Do you want to update the staging site?",icon:"warning",html:'<div class="wpstg-confirm-text-line-height wpstg-mt-10px">This will overwrite the staging site with all the selected data from the live site.<br>Use this only if you want to clone the live site again.<br><br> Unselect all tables and folders that you do not want to overwrite.<br>Do not cancel the update process! This could destroy the staging site.<br>If you are unsure, create a backup of the staging site before proceeding.<br>There is no automatic merging of database data!</div>',width:"610px",focusConfirm:!1,confirmButtonText:"Update",showCancelButton:!0,onRender:function(){document.querySelector(".wpstg--swal2-html-container").classList.remove("wpstg--swal2-html-container");var t=l.getSwalContainer().getElementsByClassName("wpstg--swal2-cancel wpstg--btn--cancel")[0],e=t.cloneNode(!0);t.parentNode.replaceChild(e,t),e.addEventListener("click",(function(t){l.closeSwalModal()}))}}).then((function(t){if(t.value){var e=document.querySelector("#wpstg-ext-db");if("wpstg_cloning"===i&&e.checked)return void h(s,r);l.closeSwalModal(),w(s,r)}})),!1}if(o.attr("disabled"))return!1;"wpstg_cloning"===o.data("action")&&e("#wpstg-ext-db").is(":checked")?h(o,t):w(o,t)})).on("click",".wpstg-prev-step-link",(function(t){t.preventDefault(),i.get(".wpstg-loader").hide(),i.get(".wpstg-loader").removeClass("wpstg-finished"),O()}))}(),i.get("#wpstg-workflow").on("click",".wpstg-tab-header",(function(t){t.preventDefault();var n=e(this),o=i.get(n.data("id"));n.toggleClass("expand"),o.slideToggle();var s=n.find(".wpstg-tab-triangle");n.hasClass("expand")?(s.removeClass("wpstg-no-icon"),s.text(""),s.addClass("wpstg-rotate-90")):s.removeClass("wpstg-rotate-90")})),l.listenTooltip(),new B,new C,new D,new U,s.notyf=new Notyf({duration:1e4,position:{x:"center",y:"bottom"},dismissible:!0,types:[{type:"warning",background:"orange",icon:!1}]})},s.ajax=g,s.showError=a,s.getLogs=F,s.loadOverview=O,s}(jQuery);jQuery(document).ready((function(){q.init(),window.WPStaging=q})),jQuery(document).ready((function(t){function e(n,o){void 0===o&&(o="false");var s=n.next(),r=t(".wpstg--tab--header .wpstg-report-email").val(),i=t(".wpstg--tab--header .wpstg-report-hosting-provider").val(),a=t(".wpstg--tab--header .wpstg-report-description").val(),c=t(".wpstg--tab--header .wpstg-report-syslog").is(":checked"),u=t(".wpstg--tab--header .wpstg-report-terms").is(":checked");n.attr("disabled",!0),s.css("visibility","visible"),t.ajax({url:ajaxurl,type:"POST",dataType:"json",async:!0,data:{action:"wpstg_send_report",accessToken:wpstg.accessToken,nonce:wpstg.nonce,wpstg_email:r,wpstg_provider:i,wpstg_message:a,wpstg_syslog:+c,wpstg_terms:+u,wpstg_force_send:o}}).done((function(o){if(n.attr("disabled",!1),s.css("visibility","hidden"),o.errors.length>0){t(".wpstg-report-issue-form .wpstg-message").remove();var r=t("<div />").addClass("wpstg-message wpstg-error-message");t.each(o.errors,(function(t,o){"already_submitted"===o.status?(r="",l.getSwalModal(!0,{container:"wpstg-issue-resubmit-confirmation"}).fire({title:"",icon:"warning",html:o.message,showCancelButton:!0,focusConfirm:!1,confirmButtonText:"Yes",cancelButtonText:"No"}).then((function(t){t.isConfirmed&&e(n,"true")}))):r.append("<p>"+o+"</p>")})),t(".wpstg-report-issue-form").prepend(r)}else{var i=t("<div />").addClass("wpstg-message wpstg-success-message");i.append("<p>Thanks for submitting your request! You should receive an auto reply mail with your ticket ID immediately for confirmation!<br><br>If you do not get that mail please contact us directly at <strong>support@wp-staging.com</strong></p>"),t(".wpstg--tab--header .wpstg-report-issue-form").html(i),null!==document.getElementById("wpstg-modal-close")&&void 0!==document.getElementById("wpstg-modal-close")||t(".wpstg--tab--header .wpstg-success-message").append('<div class="wpstg-mt-10px wpstg-float-right"><a id="wpstg-success-button" href="#" class="wpstg--red"><span class="wpstg-ml-8px">Close</span></a></div>'),setTimeout((function(){t(".wpstg--tab--header .wpstg-report-issue-form").removeClass("wpstg-report-active")}),2e3)}}))}t("body").on("click",".wpstg-report-issue-button",(function(e){var n=document.querySelector("#wpstg-contact-us-modal");null!=n&&void 0!==n&&(x("#wpstg-contact-us-modal"),new E),t(".wpstg-report-issue-form").toggleClass("wpstg-report-show"),e.preventDefault()})),t("body").on("click",".wpstg-backups-report-issue-button",(function(e){t(".wpstg-report-issue-form").toggleClass("wpstg-report-show"),e.preventDefault()})),t("body").on("click","#wpstg-report-cancel",(function(e){t(".wpstg-report-issue-form").removeClass("wpstg-report-show"),e.preventDefault()})),t("body").on("click","#wpstg-report-submit",(function(n){e(t(this),"false"),n.preventDefault()})),t("body").on("click",".wpstg--modal--process--logs--tail",(function(e){!function(){if(0!==window.WPStaging.messages.length){var t=l.getSwalContainer().querySelector(".wpstg--modal--process--logs");t.innerHTML="",window.WPStaging.messages.forEach((function(e){var n="wpstg--modal--process--msg--"+e.type.toLowerCase(),o=document.createElement("p");o.className=n,o.textContent="["+e.type+"] - ["+e.date+"] - "+e.message,t.appendChild(o)}))}}();var n=t(this);e.preventDefault();var o=l.getSwalContainer(),s=t(o).find(".wpstg--modal--process--logs");s.toggle(),s.is(":visible")?(n.text(wpstg.i18n.hideLogs),o.childNodes[0].style.width="97%",o.style["z-index"]=9999):(n.text(wpstg.i18n.showLogs),o.childNodes[0].style.width="600px")})),t("body").on("click","#wpstg-success-button",(function(e){e.preventDefault(),t(".wpstg-report-issue-form").removeClass("wpstg-report-show")})),t(document).on("click",".wpstg-dropdown>.wpstg-dropdown-toggler",(function(e){e.preventDefault(),t(e.target).next(".wpstg-dropdown-menu").toggleClass("shown"),t(e.target).find(".wpstg-caret").toggleClass("wpstg-caret-up")})),t(document).on("click",".wpstg-caret",(function(e){e.preventDefault();var n=t(e.target).closest(".wpstg-dropdown-toggler");n&&n.trigger("click")})),document.addEventListener("click",(function(e){if(!e.target.closest(".wpstg-dropdown-toggler")){for(var n=document.getElementsByClassName("wpstg-dropdown-menu"),o=0;o<n.length;o++)n[o].classList.remove("shown");t(".wpstg-caret").removeClass("wpstg-caret-up")}})),window.addEventListener("finishedProcessWithError",(function(e){t.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"wpstg_job_error",accessToken:wpstg.accessToken,nonce:wpstg.nonce,error_message:e.detail.error,job_id:l.getJobId()}})})),document.addEventListener("click",(function(t){"wpstg-login-link"===t.target.id&&(t.preventDefault(),window.open("/wp-login.php","_blank"),window.WPStaging&&window.WPStaging.wpstgProcessModal&&(window.WPStaging.wpstgProcessModal.stop(),window.WPStaging.loadOverview()))}))}))}();
//# sourceMappingURL=wpstg-admin.min.js.map
