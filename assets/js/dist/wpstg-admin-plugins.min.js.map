{"version":3,"file":"wpstg-admin-plugins.min.js","sources":["../src/wpstg-admin-plugins.js"],"sourcesContent":["let strict;\n\njQuery(document).ready(function($) {\n  /**\n   * DEACTIVATION FEEDBACK FORM\n   */\n  // show overlay when clicked on \"deactivate\"\n  const wpstg_deactivate_link = $('.wp-admin.plugins-php tr[data-slug=\"wp-staging\"] .row-actions .deactivate a');\n  const wpstg_deactivate_link_url = wpstg_deactivate_link.attr('href');\n\n  wpstg_deactivate_link.on('click', function(e) {\n    e.preventDefault();\n\n    // only show feedback form once per 30 days\n    const c_value = wpstg_admin_get_cookie('wpstg_hide_feedback');\n\n    if (c_value === undefined) {\n      $('#wpstg-feedback-overlay').show();\n    } else {\n      // click on the link\n      window.location.href = wpstg_deactivate_link_url;\n    }\n  });\n  // show text fields\n  $('#wpstg-feedback-content input[type=\"radio\"]').on('click', function() {\n    // show text field if there is one\n    $(this).parents('li').next('li').children('input[type=\"text\"], textarea').show();\n  });\n  // send form or close it\n  $('#wpstg-feedback-content .button').on('click', function(e) {\n    e.preventDefault();\n    // set cookie for 30 days\n    const exdate = new Date();\n    exdate.setSeconds(exdate.getSeconds() + 2592000);\n    document.cookie = 'wpstg_hide_feedback=1; expires=' + exdate.toUTCString() + '; path=/';\n\n    $('#wpstg-feedback-overlay').hide();\n    if ('wpstg-feedback-submit' === this.id) {\n      // Send form data\n      $.ajax({\n        type: 'POST',\n        url: ajaxurl,\n        dataType: 'json',\n        data: {\n          action: 'wpstg_send_feedback',\n          data: $('#wpstg-feedback-content form').serialize(),\n        },\n        complete: function(MLHttpRequest, textStatus, errorThrown) {\n          // deactivate the plugin and close the popup\n          $('#wpstg-feedback-overlay').remove();\n          window.location.href = wpstg_deactivate_link_url;\n        },\n      });\n    } else {\n      $('#wpstg-feedback-overlay').remove();\n      window.location.href = wpstg_deactivate_link_url;\n    }\n  });\n  // close form without doing anything\n  $('.wpstg-feedback-not-deactivate').on('click', function(e) {\n    $('#wpstg-feedback-overlay').hide();\n  });\n\n  function wpstg_admin_get_cookie(name) {\n    let i; let x; let y; const wpstg_cookies = document.cookie.split( ';' );\n    for (i = 0; i < wpstg_cookies.length; i++) {\n      x = wpstg_cookies[i].substr( 0, wpstg_cookies[i].indexOf( '=' ) );\n      y = wpstg_cookies[i].substr( wpstg_cookies[i].indexOf( '=' ) + 1 );\n      x = x.replace( /^\\s+|\\s+$/g, '' );\n      if (x === name) {\n        return unescape( y );\n      }\n    }\n  }\n});\n"],"names":["jQuery","document","ready","$","wpstg_deactivate_link","wpstg_deactivate_link_url","attr","on","e","preventDefault","undefined","name","i","x","y","wpstg_cookies","cookie","split","length","substr","indexOf","replace","unescape","wpstg_admin_get_cookie","show","window","location","href","this","parents","next","children","exdate","Date","setSeconds","getSeconds","toUTCString","hide","id","ajax","type","url","ajaxurl","dataType","data","action","serialize","complete","MLHttpRequest","textStatus","errorThrown","remove"],"mappings":"yBAEAA,OAAOC,UAAUC,OAAM,SAASC,GAK9B,IAAMC,EAAwBD,EAAE,+EAC1BE,EAA4BD,EAAsBE,KAAK,QAE7DF,EAAsBG,GAAG,SAAS,SAASC,GACzCA,EAAEC,sBAKcC,IA+ClB,SAAgCC,GAC9B,IAAIC,EAAOC,EAAOC,EAASC,EAAgBd,SAASe,OAAOC,MAAO,KAClE,IAAKL,EAAI,EAAGA,EAAIG,EAAcG,OAAQN,IAIpC,GAHAC,EAAIE,EAAcH,GAAGO,OAAQ,EAAGJ,EAAcH,GAAGQ,QAAS,MAC1DN,EAAIC,EAAcH,GAAGO,OAAQJ,EAAcH,GAAGQ,QAAS,KAAQ,IAC/DP,EAAIA,EAAEQ,QAAS,aAAc,OACnBV,EACR,OAAOW,SAAUR,EAGvB,CA3DkBS,CAAuB,uBAGrCpB,EAAE,2BAA2BqB,OAG7BC,OAAOC,SAASC,KAAOtB,CAE3B,IAEAF,EAAE,+CAA+CI,GAAG,SAAS,WAE3DJ,EAAEyB,MAAMC,QAAQ,MAAMC,KAAK,MAAMC,SAAS,gCAAgCP,MAC5E,IAEArB,EAAE,mCAAmCI,GAAG,SAAS,SAASC,GACxDA,EAAEC,iBAEF,IAAMuB,EAAS,IAAIC,KACnBD,EAAOE,WAAWF,EAAOG,aAAe,QACxClC,SAASe,OAAS,kCAAoCgB,EAAOI,cAAgB,WAE7EjC,EAAE,2BAA2BkC,OACzB,0BAA4BT,KAAKU,GAEnCnC,EAAEoC,KAAK,CACLC,KAAM,OACNC,IAAKC,QACLC,SAAU,OACVC,KAAM,CACJC,OAAQ,sBACRD,KAAMzC,EAAE,gCAAgC2C,aAE1CC,SAAU,SAASC,EAAeC,EAAYC,GAE5C/C,EAAE,2BAA2BgD,SAC7B1B,OAAOC,SAASC,KAAOtB,CACzB,KAGFF,EAAE,2BAA2BgD,SAC7B1B,OAAOC,SAASC,KAAOtB,EAE3B,IAEAF,EAAE,kCAAkCI,GAAG,SAAS,SAASC,GACvDL,EAAE,2BAA2BkC,MAC/B,GAaF"}